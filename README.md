# LaLaManDIY 小程序

LaLaManDIY 是一款提供照片处理服务的微信小程序，旨在为用户提供有趣且富有创意的照片编辑体验。

## 核心功能与交互结构

LaLaManDIY 小程序首页底部设有三个核心功能按钮，分别对应三大服务：

| 按钮 | 位置 | 功能名称 | 主要内容 |
|------|------|----------|----------|
| 乘号（×） | 左侧 | 动效 | 提供图片动效处理，包括图片转GIF动画及其他视频动效（如动态贴纸、特效等），通过API实现，用户可将静态照片变为有趣的动态内容。 |
| 加号（＋） | 中间 | 风格 | 提供图片风格转绘服务，支持多种漫画风格、绘画风格转换，如二次元、油画、水彩等，全部通过API智能生成。 |
| 等号（＝） | 右侧 | 打印 | 提供照片打印服务，包括两类产品：① 不干胶打印（可贴手机、电脑等）；② 艺术微喷画报（90×60cm及定制尺寸），由平台直接生产与发货。 |

### 详细说明

#### 1. 动效（左侧 × 按钮）
- 功能：将用户上传的照片生成GIF动画，或添加多种动态视频效果。
- 实现方式：调用后端API进行图片动效处理。
- 场景举例：制作表情包、趣味动图、短视频等。

#### 2. 风格（中间 ＋ 按钮）
- 功能：将照片一键转绘为多种漫画/艺术风格。
- 实现方式：调用AI风格转绘API，支持多种风格选择。
- 场景举例：头像漫画化、照片艺术化、社交分享等。

#### 3. 打印（右侧 ＝ 按钮）
- 功能：提供照片打印与定制服务。
- 产品类型：
  - 不干胶打印：适合贴在手机、电脑等物品上。
  - 艺术微喷画报：标准尺寸90×60cm，支持定制。
- 实现方式：用户选择图片并下单，由平台负责生产与发货。


## 设计风格

项目界面采用 VOUN 设计风格，以**黑色**为主色调，追求简洁、现代和高级感，为用户提供沉浸式的操作体验。

## 技术栈 (初步设想)

- **前端**: 微信小程序框架
- **后端**: Node.js, Express.js (或其他合适的框架)
- **数据库**: MongoDB (或其他 NoSQL/SQL 数据库)
- **AI 模型**: 可能集成用于风格转绘和动效处理的 AI 模型服务
- **云服务**: 微信云开发或自建服务器

## 页面结构与导航

- 首页（index）：功能入口，底部三个核心按钮（动效、风格、打印）。
- 动效页面（effect）：上传图片，选择动效类型，生成并预览动效。
- 风格页面（style）：上传图片，选择风格，生成并预览转绘效果。
- 打印页面（print）：选择图片，选择打印类型，填写收货信息，下单。
- 其他页面：如上传、用户中心、购物车等，支持扩展。

页面跳转关系示意：
- 首页 → 动效（乘号按钮）
- 首页 → 风格（加号按钮）
- 首页 → 打印（等号按钮）

## 接口与数据流（简述）

- 前端通过 API 上传图片、请求动效/风格处理、提交打印订单。
- 后端负责图片处理（AI/动效）、订单管理、用户信息等。
- 主要API：
  - 图片上传接口
  - 动效生成接口
  - 风格转绘接口
  - 打印下单接口
- 数据流示例：用户上传图片 → 选择功能 → 前端调用API → 后端处理 → 返回结果 → 前端展示/保存/下单

## 版本历史

### 🎯 产品愿景演进

> **LaLaMan 1.0**: 一款提供照片处理服务的工具型小程序
> 
> **LaLaMan 2.0**: 讲述老百姓自己的故事 —— 让每个人都能通过AI漫画表达自我

LaLaMan 2.0 的核心理念是让普通人也能方便地用AIGC来表达情绪和讲述小故事。这种表达会产生人与自己、与世界、与他人的连接，这是非常有意义的事情。

---

### 📦 v1.0 - 基础版本 (2024年)

**核心功能：**
- ✅ 照片风格转绘（AI风格化）
- ✅ 动效处理（图片转GIF）
- ✅ 打印服务（不干胶、艺术微喷画报）

**技术架构：**
- 前端：微信原生小程序
- 后端：PHP (Webman框架)
- AI服务：调用第三方API

---

### 📦 v1.3 - 风格扩展版 (2024年12月)

**新增风格：**
| 风格名称 | Key | 类型 |
|----------|-----|------|
| 🆕 吉卜力水彩 | `ghibli_watercolor` | 动漫 |
| 🆕 几米 | `jimmy` | 动漫 |
| 🆕 手办 Art Toy | `art_toy` | 混合 |

**技术更新：**
- 集成 Seedream 4.5 API（字节跳动）
- 支持动态风格管理（数据库配置）
- MiniApp (UniApp/Vue版本) 代码归档

**目录结构变更：**
```
lalaman-master/
├── miniapp/          # 🆕 UniApp/Vue版本前端
├── pages/            # 原生微信小程序前端
└── app/              # PHP后端
```

---

### 📦 v2.0 - 故事版本 (开发中)

**产品定位升级：**
- 从"工具型产品"转变为"故事表达平台"
- 首页瀑布流从"产品展示"变为"故事展示"
- 用户可以创作和分享自己的AI漫画故事

**Phase 1: 身份模块 ✅**
- 身份保持生成（Identity Preservation）
- 用户上传自拍后，所有生成的漫画都保持一致的面部特征
- API: `POST /api/Identity/generate`

**Phase 2: 批量生成 ✅**
- 24表情包批量生成
- Redis队列 + 后台Worker处理
- 并发控制（最多4个同时生成）
- API: `POST /api/Batch/create`

**Phase 3: 导出与质控 ✅**
- 多平台导出（微信表情包、Telegram贴纸）
- ZIP打包下载
- 图像质量评分

**24表情矩阵：**
```
开心 😊 | 难过 😢 | 生气 😠 | 惊讶 😲 | 害怕 😨 | 恶心 🤢
期待 🤩 | 困惑 🤔 | 无聊 😑 | 尴尬 😅 | 骄傲 😤 | 害羞 😳
感动 🥹 | 疲惫 😫 | 兴奋 🤪 | 焦虑 😰 | 满足 😌 | 失望 😞
好奇 🧐 | 调皮 😜 | 委屈 🥺 | 嫌弃 😒 | 佛系 🧘 | 暴走 🤯
```

**2.0 后端核心文件：**
| 文件 | 功能 |
|------|------|
| `app/utils/SeedDream4.php` | Seedream 4.5 API封装 |
| `app/api/controller/Identity.php` | 身份保持生成API |
| `app/api/controller/Batch.php` | 批量任务管理API |
| `app/api/controller/Export.php` | 导出与质控API |
| `app/model/BatchJob.php` | 批量任务数据模型 |
| `app/process/BatchWorker.php` | 后台队列处理器 |
| `app/utils/ExportService.php` | 导出格式化服务 |

---

## 未来规划

### 2.0 前端升级（待开发）
- [ ] 故事Feed瀑布流
- [ ] 故事创作流程
- [ ] 社区互动（点赞、评论、分享）
- [ ] 用户个人主页

### 长期规划
- 支持更多动效和风格类型，持续丰富AI模型能力
- 打印服务可扩展更多产品类型和尺寸
- AI故事生成（图文结合）
- 多角色故事创作

---

## 项目结构

```
lalaman-master/
├── app/                    # 后端PHP代码
│   ├── api/controller/     # API控制器
│   ├── model/              # 数据模型
│   ├── process/            # 后台进程
│   └── utils/              # 工具类
├── config/                 # 配置文件
├── pages/                  # 原生微信小程序
├── subpackages/            # 小程序分包
├── miniapp/                # UniApp/Vue版本 (v1.3新增)
├── services/               # 前端服务层
├── scripts/                # 脚本工具
└── public/                 # 静态资源
```

## 如何开始

### 后端启动
```bash
cd lalaman-master
php start.php start
```

### 前端开发
1. **原生小程序**: 使用微信开发者工具打开 `lalaman-master/` 目录
2. **UniApp版本**: 
   ```bash
   cd lalaman-master/miniapp
   npm install
   npm run dev:mp-weixin
   ```

---

*本文档将随着项目的进展持续更新。*

**最后更新**: 2024年12月29日
