import{f as j,j as e,al as t,an as C,A as y,r as c,m as S,B as h}from"./index-BTXTJVKt.js";import{a as b}from"./adminCodeGenerator-XA6WtBhQ.js";import{C as w}from"./index-BMfK2Dip.js";import{a as k}from"./adminMenu-Hr-Zrko8.js";import{S as _}from"./index-B1B7dhZb.js";import{R as W,C as u}from"./row-DJNm5-9Y.js";import{W as d}from"./index-BMuvgOFD.js";import{r as v,I as E}from"./BaseForm-Bt-x2uS5.js";import{c as L,a as P}from"./index-Cpu1JcVa.js";import{C as R}from"./index-Ci-Y97rG.js";import{W as q}from"./index-CNcHXf2n.js";import{W as A}from"./index-2DT4l-EF.js";import{A as G}from"./index-C1Zz-ieJ.js";import{P as T}from"./ProCard-BTx7yLUQ.js";import{F as D}from"./index-BGu4eHBl.js";import{P as g}from"./index-D_n6I86r.js";import{P as B}from"./index-DWwHrh8G.js";import"./index-Dx9hPCiE.js";import"./EditOutlined-Jb-cOsu8.js";import"./index-DWyRM-jO.js";import"./styleChecker-xca8e-q0.js";import"./TextArea-Dm9DBQS4.js";import"./getAllowClear-SV9Asyat.js";import"./CheckOutlined-CRheHqkM.js";import"./CopyOutlined-Bqo58qRo.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-C9P5ZgXD.js";import"./index-CsweGtVO.js";import"./index-CBjIPB84.js";import"./index-DwWsiyHK.js";import"./DeleteOutlined-sMe1csST.js";import"./PlusOutlined-DhDAnJdR.js";import"./index-BaexhYUL.js";import"./DownOutlined-dHMiLU6h.js";import"./addEventListener-BQxGY-6f.js";import"./Overflow-DodMVMUF.js";import"./iconUtil-0otcsGdb.js";import"./index-D1w3VCkm.js";import"./PurePanel-BJ0dSvru.js";import"./move-BiL2XrK1.js";import"./Input-CJszbmX7.js";import"./index-DZ2tAw4A.js";import"./LeftOutlined-CNJksXTb.js";import"./index-Wn9_u9d6.js";import"./progress-C-smal5r.js";import"./index-BfhOKpHw.js";import"./index-D5nMW6Hn.js";import"./index-lhHkabfZ.js";import"./dropdown-ozNz9IXP.js";import"./Dropdown-D-FCcTPI.js";import"./index-D2NRD51k.js";import"./EllipsisOutlined-BzWcE7tF.js";import"./Sider-clMwekzu.js";import"./index-CHGWkdWj.js";import"./index-Ck2b4VHc.js";var M=["options","fieldProps","proFieldProps","valueEnum"],I=j.forwardRef(function(r,l){var i=r.options,o=r.fieldProps,a=r.proFieldProps,n=r.valueEnum,p=C(r,M);return e.jsx(P,t({ref:l,valueType:"checkbox",valueEnum:v(n,void 0),fieldProps:t({options:i},o),lightProps:t({labelFormatter:function(){return e.jsx(P,t({ref:l,valueType:"checkbox",mode:"read",valueEnum:v(n,void 0),filedConfig:{customLightMode:!0},fieldProps:t({options:i},o),proFieldProps:a},p))}},p.lightProps),proFieldProps:a},p))}),z=j.forwardRef(function(r,l){var i=r.fieldProps,o=r.children;return e.jsx(R,t(t({ref:l},i),{},{children:o}))}),H=L(z,{valuePropName:"checked"}),x=H;x.Group=I;const Ve=({tableName:r,operationFile:l,...i})=>{const{message:o}=y.useApp(),a=c.useRef();c.useEffect(()=>{f()},[r]);const[n,p]=c.useState([]),f=()=>{k.getList({hidden:"all"}).then(s=>{s.code===1&&p(S(s.data))})},F=[{label:"get",value:"get"},{label:"post",value:"post"}];return e.jsxs(e.Fragment,{children:[e.jsx(g,{formRef:a,size:"small",params:{table_name:r},request:async s=>(await b.getCodeGeneratorInfo(s)).data||{},submitter:!1,onFinish:async s=>{b.generatorCode({controller:{...s.controller,file_suffix:"php"},table_name:r,code_name:"controller"}).then(m=>{m.code===1?(o.success(m.message),a.current.setFieldValue("controller_code",m.data.controller_code)):o.error(m.message)})},children:e.jsxs(_,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(W,{gutter:[24,0],children:[e.jsx(u,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(d,{name:["controller","file_name"],label:"控制器类名",placeholder:"请输入",rules:[{required:!0,message:"请输入"}]})}),e.jsx(u,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(d,{name:["controller","file_path"],label:"命名空间",placeholder:"请输入",extra:"控制器路劲，同时也是命名空间",rules:[{required:!0,message:"请输入"}]})}),e.jsx(u,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,children:e.jsx(x.Group,{name:["controller","functions"],label:"生成的方法",options:[{label:"获取列表",value:"getList"},{label:"新增",value:"create"},{label:"获取一条数据",value:"findData"},{label:"更新",value:"update"},{label:"删除",value:"delete"},{label:"更新排序",value:"updateSort"},{label:"更新状态",value:"updateStatus"},{label:"搜索选择某条数据",value:"select"},{label:"导入数据",value:"importData"},{label:"导出数据",value:"exportData"}]})}),e.jsx(u,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,children:e.jsx(x.Group,{name:["controller","functions_auth"],label:"需要验证接口级别权限的方法",options:[{label:"获取列表",value:"getList"},{label:"新增",value:"create"},{label:"更新",value:"update"},{label:"删除",value:"delete"},{label:"更新排序",value:"updateSort"},{label:"更新状态",value:"updateStatus"},{label:"导入数据",value:"importData"},{label:"导出数据",value:"exportData"}]})})]}),e.jsx(E,{name:["controller","other_functions"],label:"添加其它方法",creatorButtonProps:{creatorButtonText:"添加方法"},children:e.jsxs(B,{children:[e.jsx(d,{name:"title",label:"方法名称(中文)",placeholder:"请输入",rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}}),e.jsx(d,{name:"name",label:"方法名称(英文)",placeholder:"请输入",rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}}),e.jsx(q,{name:"method",label:"请求类型",placeholder:"请选择",request:async()=>F,rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}}),e.jsx(A,{name:["auth_id"],label:"访问接口权限节点(如需要)",placeholder:"请选择",rules:[],fieldProps:{style:{width:"200px"},popupMatchSelectWidth:!1,showSearch:!0,treeNodeFilterProp:"title",treeData:n,fieldNames:{lable:"title",value:"name"}}})]})}),e.jsx(g.Item,{name:"controller_code",children:e.jsx(w,{language:"php"})})]})}),e.jsx(G,{offsetBottom:10,children:e.jsx(T,{boxShadow:!0,children:e.jsxs(D,{align:"center",justify:"center",gap:"small",children:[e.jsx(h,{type:"primary",size:"default",onClick:()=>{a.current.submit()},children:"保存设置》生成预览代码"}),e.jsx(h,{danger:!0,onClick:()=>{l("controller")},children:"生成到项目"})]})})})]})};export{Ve as default};
