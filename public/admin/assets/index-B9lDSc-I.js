import{r as n,d6 as h,dh as C,A as $,j as m}from"./index-BTXTJVKt.js";import{S as w}from"./index-B1B7dhZb.js";import{I as z}from"./index-DZ2tAw4A.js";import{T as D}from"./index-SU_L7Dou.js";import{R as B}from"./DeleteOutlined-sMe1csST.js";import{R as P}from"./PlusOutlined-DhDAnJdR.js";import"./gapSize-U1swVQyS.js";import"./getAllowClear-SV9Asyat.js";import"./Input-CJszbmX7.js";import"./TextArea-Dm9DBQS4.js";import"./index-DWyRM-jO.js";var T=function(i){i===void 0&&(i=[]);var d=n.useRef(-1),a=n.useRef([]),p=n.useCallback(function(e){d.current+=1,a.current.splice(e,0,d.current)},[]),l=h(n.useState(function(){return i.forEach(function(e,t){p(t)}),i}),2),_=l[0],o=l[1],V=n.useCallback(function(e){a.current=[],o(function(){return e.forEach(function(t,s){p(s)}),e})},[]),L=n.useCallback(function(e,t){o(function(s){var c=C([],h(s),!1);return c.splice(e,0,t),p(e),c})},[]),b=n.useCallback(function(e){return a.current[e]},[]),g=n.useCallback(function(e){return a.current.findIndex(function(t){return t===e})},[]),E=n.useCallback(function(e,t){o(function(s){var c=C([],h(s),!1);return t.forEach(function(v,r){p(e+r)}),c.splice.apply(c,C([e,0],h(t),!1)),c})},[]),A=n.useCallback(function(e,t){o(function(s){var c=C([],h(s),!1);return c[e]=t,c})},[]),R=n.useCallback(function(e){o(function(t){var s=C([],h(t),!1);s.splice(e,1);try{a.current.splice(e,1)}catch(c){console.error(c)}return s})},[]),S=n.useCallback(function(e){Array.isArray(e)&&e.length&&o(function(t){var s=[],c=t.filter(function(v,r){var u=!e.includes(r);return u&&s.push(b(r)),u});return a.current=s,c})},[]),y=n.useCallback(function(e,t){e!==t&&o(function(s){var c=C([],h(s),!1),v=c.filter(function(u,f){return f!==e});v.splice(t,0,c[e]);try{var r=a.current.filter(function(u,f){return f!==e});r.splice(t,0,a.current[e]),a.current=r}catch(u){console.error(u)}return v})},[]),k=n.useCallback(function(e){o(function(t){return p(t.length),t.concat([e])})},[]),j=n.useCallback(function(){try{a.current=a.current.slice(0,a.current.length-1)}catch(e){console.error(e)}o(function(e){return e.slice(0,e.length-1)})},[]),I=n.useCallback(function(e){o(function(t){return p(0),[e].concat(t)})},[]),x=n.useCallback(function(){try{a.current=a.current.slice(1,a.current.length)}catch(e){console.error(e)}o(function(e){return e.slice(1,e.length)})},[]),K=n.useCallback(function(e){return e.map(function(t,s){return{key:s,item:t}}).sort(function(t,s){return g(t.key)-g(s.key)}).filter(function(t){return!!t.item}).map(function(t){return t.item})},[]);return{list:_,insert:L,merge:E,replace:A,remove:R,batchRemove:S,getKey:b,getIndex:g,move:y,push:k,pop:j,unshift:I,shift:x,sortList:K,resetList:V}};const X=({value:i=[],onChange:d,...a})=>{const{message:p}=$.useApp(),{list:l,remove:_,push:o,resetList:V,replace:L}=T(i);n.useEffect(()=>{i!=l&&V(i)},[i]),n.useEffect(()=>{d==null||d(l)},[l]);const b=n.useRef(),[g,E]=n.useState(!1),[A,R]=n.useState(""),S=n.useRef(),[y,k]=n.useState(null),[j,I]=n.useState(""),x=()=>{E(!0)};n.useEffect(()=>{var r;(r=b.current)==null||r.focus()},[g]);const K=r=>{R(r.target.value)},e=()=>{const r=A.replace(/^\s+|\s+$/g,"");if(!r)return E(!1),!1;l.some(u=>u==r)?(p.error("此值已存在~"),R(""),E(!1)):(o(r),R(""),setTimeout(()=>{var u;(u=b.current)==null||u.focus()},300))},t=(r,u)=>{k(r),I(u)};n.useEffect(()=>{var r;(r=S.current)==null||r.focus()},[y]);const s=r=>{I(r.target.value)},c=()=>{const r=j.replace(/^\s+|\s+$/g,"");if(!r)return k(null),!1;l.some((u,f)=>f===y&&u!=r)&&L(y,r),k(null)},v={width:78,height:22,marginInlineEnd:8,verticalAlign:"top"};return m.jsxs(w,{size:[0,8],wrap:!0,children:[l.map((r,u)=>y===u?m.jsx(z,{ref:S,size:"small",style:v,value:j,onChange:s,onBlur:c,onPressEnter:c},u):m.jsx(D,{closeIcon:m.jsx(B,{style:{fontSize:"14px",color:"#cf1322"},onClick:()=>_(u)}),onClose:f=>f.preventDefault(),children:m.jsx("span",{style:{padding:"0px 5px"},onClick:f=>{t(u,r),f.preventDefault()},children:r})},u)),g?m.jsx(z,{ref:b,type:"text",size:"small",style:v,value:A,onChange:K,onBlur:e,onPressEnter:e}):m.jsx(D,{style:{background:"#fff",borderStyle:"dashed"},icon:m.jsx(P,{}),onClick:x,children:"添加"})]})};export{X as default};
