import{A as y,r as f,j as e,B as g,dj as C,aK as R,c as u}from"./index-BTXTJVKt.js";import{I as N}from"./antd-img-crop.esm-BiYxeaxO.js";import{f as k}from"./file-HyvBP1Hh.js";/* empty css              */import{C as z}from"./index-CM2B2jkZ.js";import{I as M}from"./index-Cpu1JcVa.js";import{R as $}from"./index-DZ2tAw4A.js";import{R as A}from"./DeleteOutlined-sMe1csST.js";import{U as F}from"./index-Bms52pX5.js";import{R as S}from"./PlusOutlined-DhDAnJdR.js";import"./index-JJDTxIwy.js";import"./PurePanel-BJ0dSvru.js";import"./progress-C-smal5r.js";import"./DownOutlined-dHMiLU6h.js";import"./getAllowClear-SV9Asyat.js";import"./index-DWyRM-jO.js";import"./CheckOutlined-CRheHqkM.js";import"./index-CHGWkdWj.js";import"./EllipsisOutlined-BzWcE7tF.js";import"./Overflow-DodMVMUF.js";import"./Dropdown-D-FCcTPI.js";import"./index-DwWsiyHK.js";import"./index-BaexhYUL.js";import"./BaseForm-Bt-x2uS5.js";import"./CopyOutlined-Bqo58qRo.js";import"./row-DJNm5-9Y.js";import"./useBreakpoint-C9P5ZgXD.js";import"./index-CsweGtVO.js";import"./index-CBjIPB84.js";import"./index-B1B7dhZb.js";import"./gapSize-U1swVQyS.js";import"./addEventListener-BQxGY-6f.js";import"./iconUtil-0otcsGdb.js";import"./index-D1w3VCkm.js";import"./move-BiL2XrK1.js";import"./Input-CJszbmX7.js";import"./index-Ci-Y97rG.js";import"./LeftOutlined-CNJksXTb.js";import"./index-Wn9_u9d6.js";import"./index-BfhOKpHw.js";import"./index-D5nMW6Hn.js";import"./TextArea-Dm9DBQS4.js";const ye=({value:m,onChange:l,width:o=0,height:a=0,UploadButton:i=null,...V})=>{const{message:s}=y.useApp(),[x,t]=f.useState(!1),j=r=>{var p,d;if(r.file.status==="uploading"&&i&&s.open({type:"loading",content:"正在上传...",duration:0,key:"upload"}),r.file.status!=="uploading"&&i&&s.destroy("upload"),r.file.status==="uploading"&&t(!0),r.file.status==="error"){const b=((p=r.file.error)==null?void 0:p.message)||((d=r.file.response)==null?void 0:d.message)||"图片限制在1M以内~";s.error(b),t(!1)}r.file.status==="done"&&(r.file.response.code===1?l(r.file.response.data.img):s.error("后端上传图片失败~"),t(!1))},h=()=>{l("")},[n,I]=f.useState(!1),c=()=>{I(!n)},v=r=>r.type.startsWith("image/")?r.size/1024/1024>u.uploadImgMax?(s.error(`图片太大，请控制在 ${u.uploadImgMax}M 以内~`),t(!1),!1):!0:(s.error("只能上传图片~"),t(!1),!1);return e.jsx(e.Fragment,{children:m?e.jsx(e.Fragment,{children:e.jsx(z,{className:"uploaddan-img",size:"small",styles:{body:{padding:8}},children:e.jsxs("div",{className:"bg",children:[e.jsx(M,{src:`${m}`,preview:{visible:n,onVisibleChange:c}}),e.jsx("div",{className:"hover",children:e.jsxs("div",{children:[e.jsx(g,{type:"text",size:"small",onClick:c,children:e.jsx($,{className:"icon"})}),e.jsx(g,{type:"text",size:"small",onClick:h,children:e.jsx(A,{className:"icon"})})]})})]})})}):e.jsx(e.Fragment,{children:e.jsx(N,{rotationSlider:!0,quality:1,fillColor:"rgba(0,0,0,0)",cropShape:"rect",aspect:()=>o/a,beforeCrop:()=>{if(o<=0||a<=0)return!1},resize:!1,children:e.jsx(F,{accept:"image/*",capture:null,name:"img",listType:i?"picture":"picture-card",showUploadList:!1,action:k.uploadUrl,headers:{token:C()},data:{width:o,height:a},onChange:j,beforeUpload:v,children:i?e.jsx(i,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{children:[x?e.jsx(R,{}):e.jsx(S,{}),e.jsx("div",{className:"ant-upload-text",children:"上传"})]})})})})})})};export{ye as default};
