import{A as y,r as f,j as e,B as g,dj as C,aK as R,c as u}from"./index-CxoETvRH.js";import{I as N}from"./antd-img-crop.esm-DlFTDGwj.js";import{f as k}from"./file-Clf_3ubf.js";/* empty css              */import{C as z}from"./index-BLklr69N.js";import{I as M}from"./index-DsYJmDxZ.js";import{R as $}from"./index-4oTavk15.js";import{R as A}from"./DeleteOutlined-CBiNWy3g.js";import{U as F}from"./index-BDTAXPlV.js";import{R as S}from"./PlusOutlined-vk23tUE5.js";import"./index-BOtvnYjU.js";import"./PurePanel-Qn0-6z3A.js";import"./progress-Ofxp_QxA.js";import"./DownOutlined-CKTuMrT9.js";import"./getAllowClear-61dfOySQ.js";import"./index-C-0gitmI.js";import"./CheckOutlined-DNlRZmOM.js";import"./index-CVyj0YhM.js";import"./EllipsisOutlined-DYRNvKIw.js";import"./Overflow-C1Gv4RUW.js";import"./Dropdown-B_0_MLsu.js";import"./index-DPelJOqh.js";import"./index-CvzSf1Bg.js";import"./BaseForm-Ce_dWbWI.js";import"./CopyOutlined-DoMFKUVx.js";import"./row-qzGwq4Dr.js";import"./useBreakpoint-9N_aLd03.js";import"./index-C_bV-DnG.js";import"./index-Bcl-gWmM.js";import"./index-BphrQzO9.js";import"./gapSize-U1swVQyS.js";import"./addEventListener-DSaIWks1.js";import"./iconUtil-CrL5XMUw.js";import"./index-BbWS0DN_.js";import"./move-BEwii-fV.js";import"./Input-DBs5aIW3.js";import"./index-BCcQRwwP.js";import"./LeftOutlined-CXR1ue2q.js";import"./index-BiKlR4w8.js";import"./index-r-JVz4Yx.js";import"./index-BZDhPRiF.js";import"./TextArea-B06lod9y.js";const ye=({value:m,onChange:l,width:o=0,height:a=0,UploadButton:i=null,...V})=>{const{message:s}=y.useApp(),[x,t]=f.useState(!1),j=r=>{var p,d;if(r.file.status==="uploading"&&i&&s.open({type:"loading",content:"正在上传...",duration:0,key:"upload"}),r.file.status!=="uploading"&&i&&s.destroy("upload"),r.file.status==="uploading"&&t(!0),r.file.status==="error"){const b=((p=r.file.error)==null?void 0:p.message)||((d=r.file.response)==null?void 0:d.message)||"图片限制在1M以内~";s.error(b),t(!1)}r.file.status==="done"&&(r.file.response.code===1?l(r.file.response.data.img):s.error("后端上传图片失败~"),t(!1))},h=()=>{l("")},[n,I]=f.useState(!1),c=()=>{I(!n)},v=r=>r.type.startsWith("image/")?r.size/1024/1024>u.uploadImgMax?(s.error(`图片太大，请控制在 ${u.uploadImgMax}M 以内~`),t(!1),!1):!0:(s.error("只能上传图片~"),t(!1),!1);return e.jsx(e.Fragment,{children:m?e.jsx(e.Fragment,{children:e.jsx(z,{className:"uploaddan-img",size:"small",styles:{body:{padding:8}},children:e.jsxs("div",{className:"bg",children:[e.jsx(M,{src:`${m}`,preview:{visible:n,onVisibleChange:c}}),e.jsx("div",{className:"hover",children:e.jsxs("div",{children:[e.jsx(g,{type:"text",size:"small",onClick:c,children:e.jsx($,{className:"icon"})}),e.jsx(g,{type:"text",size:"small",onClick:h,children:e.jsx(A,{className:"icon"})})]})})]})})}):e.jsx(e.Fragment,{children:e.jsx(N,{rotationSlider:!0,quality:1,fillColor:"rgba(0,0,0,0)",cropShape:"rect",aspect:()=>o/a,beforeCrop:()=>{if(o<=0||a<=0)return!1},resize:!1,children:e.jsx(F,{accept:"image/*",capture:null,name:"img",listType:i?"picture":"picture-card",showUploadList:!1,action:k.uploadUrl,headers:{token:C()},data:{width:o,height:a},onChange:j,beforeUpload:v,children:i?e.jsx(i,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{children:[x?e.jsx(R,{}):e.jsx(S,{}),e.jsx("div",{className:"ant-upload-text",children:"上传"})]})})})})})})};export{ye as default};
