import{al as m,am as a,r as x,ao as $,j as s,B as ae,g as H,f as z,F as Ce,az as Z,aC as se,aM as ee,aN as O,an as G,ap as oe,aL as ye}from"./index-CxoETvRH.js";import{o as xe,b as ne,y as be,A as Fe,F as Se,a as te,B as Pe}from"./BaseForm-Ce_dWbWI.js";import{F as ie}from"./index-C_bV-DnG.js";import{u as J,d as fe,e as de}from"./index-DPelJOqh.js";import{R as we}from"./DownOutlined-CKTuMrT9.js";import{P as Ie}from"./index-Bcl-gWmM.js";var Re=function(e){return a({},e.componentCls,{display:"flex",justifyContent:"space-between",paddingBlock:8,paddingInlineStart:8,paddingInlineEnd:8,borderBlockStart:"1px solid ".concat(e.colorSplit)})};function je(f){return J("DropdownFooter",function(e){var r=m(m({},e),{},{componentCls:".".concat(f)});return[Re(r)]})}var Be=function(e){var r=fe(),o=e.onClear,n=e.onConfirm,c=e.disabled,p=e.footerRender,i=x.useContext($.ConfigContext),t=i.getPrefixCls,l=t("pro-core-dropdown-footer"),C=je(l),y=C.wrapSSR,P=C.hashId,v=[s.jsx(ae,{style:{visibility:o?"visible":"hidden"},type:"link",size:"small",disabled:c,onClick:function(u){o&&o(u),u.stopPropagation()},children:r.getMessage("form.lightFilter.clear","清除")},"clear"),s.jsx(ae,{"data-type":"confirm",type:"primary",size:"small",onClick:n,disabled:c,children:r.getMessage("form.lightFilter.confirm","确认")},"confirm")];if(p===!1||(p==null?void 0:p(n,o))===!1)return null;var d=(p==null?void 0:p(n,o))||v;return y(s.jsx("div",{className:H(l,P),onClick:function(u){return u.target.getAttribute("data-type")!=="confirm"&&u.stopPropagation()},children:d}))},Ne=function(e){return a({},e.componentCls,a(a(a(a(a(a(a(a({display:"inline-flex",gap:e.marginXXS,alignItems:"center",height:"30px",paddingBlock:0,paddingInline:8,fontSize:e.fontSize,lineHeight:"30px",borderRadius:"2px",cursor:"pointer","&:hover":{backgroundColor:e.colorBgTextHover},"&-active":a({paddingBlock:0,paddingInline:8,backgroundColor:e.colorBgTextHover},"&".concat(e.componentCls,"-allow-clear:hover:not(").concat(e.componentCls,"-disabled)"),a(a({},"".concat(e.componentCls,"-arrow"),{display:"none"}),"".concat(e.componentCls,"-close"),{display:"inline-flex"}))},"".concat(e.antCls,"-select"),a({},"".concat(e.antCls,"-select-clear"),{borderRadius:"50%"})),"".concat(e.antCls,"-picker"),a({},"".concat(e.antCls,"-picker-clear"),{borderRadius:"50%"})),"&-icon",a(a({color:e.colorIcon,transition:"color 0.3s",fontSize:12,verticalAlign:"middle"},"&".concat(e.componentCls,"-close"),{display:"none",fontSize:12,alignItems:"center",justifyContent:"center",color:e.colorTextPlaceholder,borderRadius:"50%"}),"&:hover",{color:e.colorIconHover})),"&-disabled",a({color:e.colorTextPlaceholder,cursor:"not-allowed"},"".concat(e.componentCls,"-icon"),{color:e.colorTextPlaceholder})),"&-small",a(a(a({height:"24px",paddingBlock:0,paddingInline:4,fontSize:e.fontSizeSM,lineHeight:"24px"},"&".concat(e.componentCls,"-active"),{paddingBlock:0,paddingInline:8}),"".concat(e.componentCls,"-icon"),{paddingBlock:0,paddingInline:0}),"".concat(e.componentCls,"-close"),{marginBlockStart:"-2px",paddingBlock:4,paddingInline:4,fontSize:"6px"})),"&-bordered",{height:"32px",paddingBlock:0,paddingInline:8,border:"".concat(e.lineWidth,"px solid ").concat(e.colorBorder),borderRadius:"@border-radius-base"}),"&-bordered&-small",{height:"24px",paddingBlock:0,paddingInline:8}),"&-bordered&-active",{backgroundColor:e.colorBgContainer}))};function Te(f){return J("FieldLabel",function(e){var r=m(m({},e),{},{componentCls:".".concat(f)});return[Ne(r)]})}var Ae=function(e,r){var o,n,c,p=e.label,i=e.onClear,t=e.value,l=e.disabled,C=e.onLabelClick,y=e.ellipsis,P=e.placeholder,v=e.className,d=e.formatter,b=e.bordered,u=e.style,T=e.downIcon,g=e.allowClear,F=g===void 0?!0:g,h=e.valueMaxLength,w=h===void 0?41:h,j=($===null||$===void 0||(o=$.useConfig)===null||o===void 0?void 0:o.call($))||{componentSize:"middle"},B=j.componentSize,N=B,K=x.useContext($.ConfigContext),q=K.getPrefixCls,A=q("pro-core-field-label"),L=Te(A),Q=L.wrapSSR,W=L.hashId,U=fe(),Y=x.useRef(null),D=x.useRef(null);x.useImperativeHandle(r,function(){return{labelRef:D,clearRef:Y}});var V=function(S){return S.every(function(R){return typeof R=="string"})?S.join(","):S.map(function(R,M){var k=M===S.length-1?"":",";return typeof R=="string"?s.jsxs("span",{children:[R,k]},M):s.jsxs("span",{style:{display:"flex"},children:[R,k]},M)})},X=function(S){return d?d(S):Array.isArray(S)?V(S):S},E=function(S,R){if(R!=null&&R!==""&&(!Array.isArray(R)||R.length)){var M,k,le=S?s.jsxs("span",{onClick:function(){C==null||C()},className:"".concat(A,"-text"),children:[S,": "]}):"",_=X(R);if(!y)return s.jsxs("span",{style:{display:"inline-flex",alignItems:"center"},children:[le,X(R)]});var ve=function(){var ge=Array.isArray(R)&&R.length>1,he=U.getMessage("form.lightFilter.itemUnit","项");return typeof _=="string"&&_.length>w&&ge?"...".concat(R.length).concat(he):""},me=ve();return s.jsxs("span",{title:typeof _=="string"?_:void 0,style:{display:"inline-flex",alignItems:"center"},children:[le,s.jsx("span",{style:{paddingInlineStart:4,display:"flex"},children:typeof _=="string"?_==null||(M=_.toString())===null||M===void 0||(k=M.slice)===null||k===void 0?void 0:k.call(M,0,w):_}),me]})}return S||P};return Q(s.jsxs("span",{className:H(A,W,"".concat(A,"-").concat((n=(c=e.size)!==null&&c!==void 0?c:N)!==null&&n!==void 0?n:"middle"),a(a(a(a({},"".concat(A,"-active"),(Array.isArray(t)?t.length>0:!!t)||t===0),"".concat(A,"-disabled"),l),"".concat(A,"-bordered"),b),"".concat(A,"-allow-clear"),F),v),style:u,ref:D,onClick:function(){var S;e==null||(S=e.onClick)===null||S===void 0||S.call(e)},children:[E(p,t),(t||t===0)&&F&&s.jsx(Ce,{role:"button",title:U.getMessage("form.lightFilter.clear","清除"),className:H("".concat(A,"-icon"),W,"".concat(A,"-close")),onClick:function(S){l||i==null||i(),S.stopPropagation()},ref:Y}),T!==!1?T??s.jsx(we,{className:H("".concat(A,"-icon"),W,"".concat(A,"-arrow"))}):null]}))},Me=z.forwardRef(Ae),$e=function(e){return a(a(a({},"".concat(e.componentCls,"-label"),{cursor:"pointer"}),"".concat(e.componentCls,"-overlay"),{minWidth:"200px",marginBlockStart:"4px"}),"".concat(e.componentCls,"-content"),{paddingBlock:16,paddingInline:16})};function Ee(f){return J("FilterDropdown",function(e){var r=m(m({},e),{},{componentCls:".".concat(f)});return[$e(r)]})}var ze=function(e){var r=e.children,o=e.label,n=e.footer,c=e.open,p=e.onOpenChange,i=e.disabled,t=e.onVisibleChange,l=e.visible,C=e.footerRender,y=e.placement,P=x.useContext($.ConfigContext),v=P.getPrefixCls,d=v("pro-core-field-dropdown"),b=Ee(d),u=b.wrapSSR,T=b.hashId,g=xe(c||l||!1,p||t),F=x.useRef(null);return u(s.jsx(Ie,m(m({placement:y,trigger:["click"]},g),{},{overlayInnerStyle:{padding:0},content:s.jsxs("div",{ref:F,className:H("".concat(d,"-overlay"),a(a({},"".concat(d,"-overlay-").concat(y),y),"hashId",T)),children:[s.jsx($,{getPopupContainer:function(){return F.current||document.body},children:s.jsx("div",{className:"".concat(d,"-content ").concat(T).trim(),children:r})}),n&&s.jsx(Be,m({disabled:i,footerRender:C},n))]}),children:s.jsx("span",{className:"".concat(d,"-label ").concat(T).trim(),children:o})})))},ce=function(e,r){return typeof r=="function"?r(de(e)):de(e).format(r)},De=function(e,r){var o=Array.isArray(e)?e:[],n=Z(o,2),c=n[0],p=n[1],i,t;Array.isArray(r)?(i=r[0],t=r[1]):se(r)==="object"&&r.type==="mask"?(i=r.format,t=r.format):(i=r,t=r);var l=c?ce(c,i):"",C=p?ce(p,t):"",y=l&&C?"".concat(l," ~ ").concat(C):"";return y};function Ve(f,e){var r=ne(f),o=x.useRef(),n=x.useCallback(function(){o.current&&(clearTimeout(o.current),o.current=null)},[]),c=x.useCallback(ee(O().mark(function p(){var i,t,l,C=arguments;return O().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:for(i=C.length,t=new Array(i),l=0;l<i;l++)t[l]=C[l];if(!(e===0||e===void 0)){P.next=3;break}return P.abrupt("return",r.apply(void 0,t));case 3:return n(),P.abrupt("return",new Promise(function(v){o.current=setTimeout(ee(O().mark(function d(){return O().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.t0=v,u.next=3,r.apply(void 0,t);case 3:return u.t1=u.sent,(0,u.t0)(u.t1),u.abrupt("return");case 6:case"end":return u.stop()}},d)})),e)}));case 5:case"end":return P.stop()}},p)})),[r,n,e]);return x.useEffect(function(){return n},[n]),{run:c,cancel:n}}var _e=function(e,r,o){return be(e,r,o)};function re(f,e){var r=x.useRef();return _e(f,r.current,e)||(r.current=f),r.current}function ln(f,e,r){x.useEffect(f,re(e||[],r))}function an(f,e,r,o){var n=Ve(ee(O().mark(function c(){return O().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:f();case 1:case"end":return i.stop()}},c)})),o||16);x.useEffect(function(){n.run()},re(e||[],r))}function Le(f,e){return z.useMemo(f,re(e))}var We=function(e){var r=!1;return(typeof e=="string"&&e.startsWith("date")&&!e.endsWith("Range")||e==="select"||e==="time")&&(r=!0),r},ke=["children","onChange","onBlur","ignoreFormItem","valuePropName"],Oe=["children","addonAfter","addonBefore","valuePropName","addonWarpStyle","convertValue","help"],He=["valueType","transform","dataFormat","ignoreFormItem","lightProps","children"],Ke=z.createContext({}),Ye=function(e){var r,o,n=e.children,c=e.onChange,p=e.onBlur;e.ignoreFormItem;var i=e.valuePropName,t=i===void 0?"value":i,l=G(e,ke),C=(n==null||(r=n.type)===null||r===void 0?void 0:r.displayName)!=="ProFormComponent",y=!z.isValidElement(n),P=ne(function(){for(var g,F,h,w,j=arguments.length,B=new Array(j),N=0;N<j;N++)B[N]=arguments[N];c==null||c.apply(void 0,B),!C&&(y||(n==null||(g=n.props)===null||g===void 0||(F=g.onChange)===null||F===void 0||F.call.apply(F,[g].concat(B)),n==null||(h=n.props)===null||h===void 0||(h=h.fieldProps)===null||h===void 0||(w=h.onChange)===null||w===void 0||w.call.apply(w,[h].concat(B))))}),v=ne(function(){var g,F,h,w;if(!C&&!y){for(var j=arguments.length,B=new Array(j),N=0;N<j;N++)B[N]=arguments[N];p==null||p.apply(void 0,B),n==null||(g=n.props)===null||g===void 0||(F=g.onBlur)===null||F===void 0||F.call.apply(F,[g].concat(B)),n==null||(h=n.props)===null||h===void 0||(h=h.fieldProps)===null||h===void 0||(w=h.onBlur)===null||w===void 0||w.call.apply(w,[h].concat(B))}}),d=Le(function(){var g;return oe((n==null||(g=n.props)===null||g===void 0?void 0:g.fieldProps)||{},["onBlur","onChange"])},[oe((n==null||(o=n.props)===null||o===void 0?void 0:o.fieldProps)||{},["onBlur","onChange"])]),b=e[t],u=x.useMemo(function(){if(!C&&!y)return te(m(m(a({id:l.id},t,b),d),{},{onBlur:v,onChange:P}))},[b,d,v,P,l.id,t]),T=x.useMemo(function(){if(!u&&z.isValidElement(n))return function(){for(var g,F,h=arguments.length,w=new Array(h),j=0;j<h;j++)w[j]=arguments[j];c==null||c.apply(void 0,w),n==null||(g=n.props)===null||g===void 0||(F=g.onChange)===null||F===void 0||F.call.apply(F,[g].concat(w))}},[u,n,c]);return z.isValidElement(n)?z.cloneElement(n,te(m(m(m({},l),{},a({},t,e[t]),n.props),{},{onChange:T,fieldProps:u,onBlur:C&&!y&&p}))):s.jsx(s.Fragment,{children:n})},ue=function(e){var r=e.children,o=e.addonAfter,n=e.addonBefore,c=e.valuePropName,p=e.addonWarpStyle,i=e.convertValue,t=e.help,l=G(e,Oe),C=x.useMemo(function(){var y=function(v){var d,b=(d=i==null?void 0:i(v,l.name))!==null&&d!==void 0?d:v;return l.getValueProps?l.getValueProps(b):a({},c||"value",b)};return!i&&!l.getValueProps&&(y=void 0),!o&&!n?s.jsx(ie.Item,m(m({},l),{},{valuePropName:c,getValueProps:y,children:r})):s.jsx(ie.Item,m(m(m({},l),{},{help:typeof t!="function"?t:void 0,valuePropName:c,_internalItemRender:{mark:"pro_table_render",render:function(v,d){return s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:m({display:"flex",alignItems:"center",flexWrap:"wrap"},p),children:[n?s.jsx("div",{style:{marginInlineEnd:8},children:n}):null,d.input,o?s.jsx("div",{style:{marginInlineStart:8},children:o}):null]}),typeof t=="function"?t({errors:v.errors,warnings:v.warnings}):d.errorList,d.extra]})}}},l),{},{getValueProps:y,children:r}))},[o,n,r,i==null?void 0:i.toString(),l]);return s.jsx(Ke.Provider,{value:{name:l.name,label:l.label},children:C})},on=function(e){var r,o,n,c,p=($===null||$===void 0||(r=$.useConfig)===null||r===void 0?void 0:r.call($))||{componentSize:"middle"},i=p.componentSize,t=i,l=e.valueType,C=e.transform,y=e.dataFormat,P=e.ignoreFormItem,v=e.lightProps;e.children;var d=G(e,He),b=x.useContext(Fe),u=x.useMemo(function(){return e.name===void 0?e.name:b.name!==void 0?[b.name,e.name].flat(1):e.name},[b.name,e.name]),T=z.useContext(Se),g=T.setFieldValueType,F=T.formItemProps;x.useEffect(function(){!g||!e.name||g([b.listName,e.name].flat(1).filter(function(K){return K!==void 0}),{valueType:l||"text",dateFormat:y,transform:C})},[b.listName,u,y,e.name,g,C,l]);var h=z.isValidElement(e.children)&&We(l||e.children.props.valueType),w=x.useMemo(function(){return!!(!(v!=null&&v.light)||v!=null&&v.customLightMode||h)},[v==null?void 0:v.customLightMode,h,v==null?void 0:v.light]);if(typeof e.children=="function"){var j;return x.createElement(ue,m(m({},d),{},{name:u,key:d.proFormFieldKey||((j=d.name)===null||j===void 0?void 0:j.toString())}),e.children)}var B=s.jsx(Ye,{valuePropName:e.valuePropName,children:e.children},d.proFormFieldKey||((o=d.name)===null||o===void 0?void 0:o.toString())),N=w?B:x.createElement(Ge,m(m({},v),{},{key:d.proFormFieldKey||((n=d.name)===null||n===void 0?void 0:n.toString()),size:t}),B);return P?s.jsx(s.Fragment,{children:N}):s.jsx(ue,m(m(m({},F),d),{},{name:u,isListField:b.name!==void 0,children:N}),d.proFormFieldKey||((c=d.name)===null||c===void 0?void 0:c.toString()))},qe=function(e){return a(a({},"".concat(e.componentCls,"-collapse-label"),{paddingInline:1,paddingBlock:1}),"".concat(e.componentCls,"-container"),a({},"".concat(e.antCls,"-form-item"),{marginBlockEnd:0}))};function Ue(f){return J("LightWrapper",function(e){var r=m(m({},e),{},{componentCls:".".concat(f)});return[qe(r)]})}var Xe=["label","size","disabled","onChange","className","style","children","valuePropName","placeholder","labelFormatter","bordered","footerRender","allowClear","otherFieldProps","valueType","placement"],Ge=function(e){var r=e.label,o=e.size,n=e.disabled,c=e.onChange,p=e.className,i=e.style,t=e.children,l=e.valuePropName,C=e.placeholder,y=e.labelFormatter,P=e.bordered,v=e.footerRender,d=e.allowClear,b=e.otherFieldProps,u=e.valueType,T=e.placement,g=G(e,Xe),F=x.useContext($.ConfigContext),h=F.getPrefixCls,w=h("pro-field-light-wrapper"),j=Ue(w),B=j.wrapSSR,N=j.hashId,K=x.useState(e[l]),q=Z(K,2),A=q[0],L=q[1],Q=ye(!1),W=Z(Q,2),U=W[0],Y=W[1],D=function(){for(var I,S=arguments.length,R=new Array(S),M=0;M<S;M++)R[M]=arguments[M];b==null||(I=b.onChange)===null||I===void 0||I.call.apply(I,[b].concat(R)),c==null||c.apply(void 0,R)},V=e[l],X=x.useMemo(function(){var E;return V&&(u!=null&&(E=u.toLowerCase())!==null&&E!==void 0&&E.endsWith("range")&&u!=="digitRange"&&!y?De(V,Pe[u]||"YYYY-MM-DD"):Array.isArray(V)?V.map(function(I){return se(I)==="object"&&I.label&&I.value?I.label:I}):V)},[V,u,y]);return B(s.jsx(ze,{disabled:n,open:U,onOpenChange:Y,placement:T,label:s.jsx(Me,{ellipsis:!0,size:o,onClear:function(){D==null||D(),L(null)},bordered:P,style:i,className:p,label:r,placeholder:C,value:X,disabled:n,formatter:y,allowClear:d}),footer:{onClear:function(){return L(null)},onConfirm:function(){D==null||D(A),Y(!1)}},footerRender:v,children:s.jsx("div",{className:H("".concat(w,"-container"),N,p),style:i,children:z.cloneElement(t,m(m({},g),{},a(a({},l,A),"onChange",function(I){L(I!=null&&I.target?I.target.value:I)}),t.props))})}))};export{Me as F,on as P,Ve as a,ln as b,Le as c,ze as d,an as u};
