import{A as y,r as f,j as e,B as g,dj as C,aK as R,c as u}from"./index-ZI51y314.js";import{I as N}from"./antd-img-crop.esm-u9quxmEX.js";import{f as k}from"./file-lMMXiPj9.js";/* empty css              */import{C as z}from"./index-5Jfw_ME_.js";import{I as M}from"./index-B_vyTJVd.js";import{R as $}from"./index-CzgBx6dd.js";import{R as A}from"./DeleteOutlined-BJQ6Ec5G.js";import{U as F}from"./index-B-1LKTLM.js";import{R as S}from"./PlusOutlined-BrSmXzHo.js";import"./index-rQeGZp6R.js";import"./PurePanel-IzJJVpwi.js";import"./progress-DyKaNkG9.js";import"./DownOutlined-BvFNYu2h.js";import"./getAllowClear-Bb8ihI2F.js";import"./index-BIgUuT9u.js";import"./CheckOutlined-BH5QPYjn.js";import"./index-DuZOyzfN.js";import"./EllipsisOutlined-rOnf-sW7.js";import"./Overflow-6EGZ5_au.js";import"./Dropdown-D-H8baFE.js";import"./index-BQOafed3.js";import"./index-Dm2ANYsS.js";import"./BaseForm-Dt9roNn_.js";import"./CopyOutlined-Di_ABAcP.js";import"./row-CA0HzO8K.js";import"./useBreakpoint-LlaO7o8U.js";import"./index-DPgpDBVC.js";import"./index-DxRnNHO_.js";import"./index-DFWIh5En.js";import"./gapSize-U1swVQyS.js";import"./addEventListener-2k7hxYrj.js";import"./iconUtil-snskxn8a.js";import"./index-C4Es4GTO.js";import"./move-D1aXciBO.js";import"./Input-YyHXjDeB.js";import"./index-B94rXkjj.js";import"./LeftOutlined-DLD2DGED.js";import"./index-D32vO3So.js";import"./index-CJ6fB5dR.js";import"./index-Bo_cWNs1.js";import"./TextArea-CbhGwHw0.js";const ye=({value:m,onChange:l,width:o=0,height:a=0,UploadButton:i=null,...V})=>{const{message:s}=y.useApp(),[x,t]=f.useState(!1),j=r=>{var p,d;if(r.file.status==="uploading"&&i&&s.open({type:"loading",content:"正在上传...",duration:0,key:"upload"}),r.file.status!=="uploading"&&i&&s.destroy("upload"),r.file.status==="uploading"&&t(!0),r.file.status==="error"){const b=((p=r.file.error)==null?void 0:p.message)||((d=r.file.response)==null?void 0:d.message)||"图片限制在1M以内~";s.error(b),t(!1)}r.file.status==="done"&&(r.file.response.code===1?l(r.file.response.data.img):s.error("后端上传图片失败~"),t(!1))},h=()=>{l("")},[n,I]=f.useState(!1),c=()=>{I(!n)},v=r=>r.type.startsWith("image/")?r.size/1024/1024>u.uploadImgMax?(s.error(`图片太大，请控制在 ${u.uploadImgMax}M 以内~`),t(!1),!1):!0:(s.error("只能上传图片~"),t(!1),!1);return e.jsx(e.Fragment,{children:m?e.jsx(e.Fragment,{children:e.jsx(z,{className:"uploaddan-img",size:"small",styles:{body:{padding:8}},children:e.jsxs("div",{className:"bg",children:[e.jsx(M,{src:`${m}`,preview:{visible:n,onVisibleChange:c}}),e.jsx("div",{className:"hover",children:e.jsxs("div",{children:[e.jsx(g,{type:"text",size:"small",onClick:c,children:e.jsx($,{className:"icon"})}),e.jsx(g,{type:"text",size:"small",onClick:h,children:e.jsx(A,{className:"icon"})})]})})]})})}):e.jsx(e.Fragment,{children:e.jsx(N,{rotationSlider:!0,quality:1,fillColor:"rgba(0,0,0,0)",cropShape:"rect",aspect:()=>o/a,beforeCrop:()=>{if(o<=0||a<=0)return!1},resize:!1,children:e.jsx(F,{accept:"image/*",capture:null,name:"img",listType:i?"picture":"picture-card",showUploadList:!1,action:k.uploadUrl,headers:{token:C()},data:{width:o,height:a},onChange:j,beforeUpload:v,children:i?e.jsx(i,{}):e.jsx(e.Fragment,{children:e.jsxs("div",{children:[x?e.jsx(R,{}):e.jsx(S,{}),e.jsx("div",{className:"ant-upload-text",children:"上传"})]})})})})})})};export{ye as default};
