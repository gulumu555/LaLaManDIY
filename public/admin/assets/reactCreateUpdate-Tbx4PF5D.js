import{A as ae,r as c,j as e,B as I}from"./index-CxoETvRH.js";import{a as S}from"./adminCodeGenerator-o3VPck0b.js";import{C as v}from"./index-vDDUv-ak.js";import{S as te}from"./index-BphrQzO9.js";import{R as M,C as f}from"./row-qzGwq4Dr.js";import{W as R}from"./index-DqNJzPla.js";import{W as n}from"./index-w3B4RVYE.js";import{P as d}from"./index-DsYJmDxZ.js";import{D as re}from"./index-DUMZawVF.js";import{W as P}from"./index-B5gW4Hci.js";import{A as ie}from"./index-CKDIzB68.js";import{P as oe}from"./ProCard-D6QkQ_g5.js";import{F as se}from"./index-DZIFP8d9.js";import{F as j}from"./index-DiLyVsjM.js";import{T as ne}from"./index-C-0gitmI.js";import{R as pe}from"./index-C_bV-DnG.js";import{P as x}from"./index-BV5Zm_mO.js";import"./index-DdonXCdW.js";import"./EditOutlined-DSBmrQxq.js";import"./styleChecker-BWYb9pEX.js";import"./TextArea-B06lod9y.js";import"./getAllowClear-61dfOySQ.js";import"./CheckOutlined-DNlRZmOM.js";import"./CopyOutlined-DoMFKUVx.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-9N_aLd03.js";import"./BaseForm-Ce_dWbWI.js";import"./index-DPelJOqh.js";import"./DeleteOutlined-CBiNWy3g.js";import"./PlusOutlined-vk23tUE5.js";import"./addEventListener-DSaIWks1.js";import"./Overflow-C1Gv4RUW.js";import"./iconUtil-CrL5XMUw.js";import"./index-BbWS0DN_.js";import"./PurePanel-Qn0-6z3A.js";import"./move-BEwii-fV.js";import"./DownOutlined-CKTuMrT9.js";import"./Input-DBs5aIW3.js";import"./index-BCcQRwwP.js";import"./index-CvzSf1Bg.js";import"./index-Bcl-gWmM.js";import"./index-4oTavk15.js";import"./LeftOutlined-CXR1ue2q.js";import"./index-BiKlR4w8.js";import"./progress-Ofxp_QxA.js";import"./index-r-JVz4Yx.js";import"./index-BZDhPRiF.js";import"./Table-MBA0ODj2.js";import"./index-CVCROCWL.js";import"./index-EKub9ikS.js";import"./Table-dye4hUJ0.js";import"./index-D0fE36s2.js";import"./dropdown-0heBmOdg.js";import"./Dropdown-B_0_MLsu.js";import"./index-27J4tOGW.js";import"./EllipsisOutlined-DYRNvKIw.js";import"./Sider-DIX9tLFZ.js";import"./index-DRn2fARs.js";import"./HolderOutlined-c3sLJRZN.js";import"./CaretDownOutlined-Cm7GLJFD.js";import"./index-0Umo49A8.js";import"./index-CHnZ-yQ1.js";import"./index-JNVvr94D.js";import"./index-lKg4xbVK.js";import"./index-lhHkabfZ.js";import"./index-Dx6Z95tT.js";import"./index-B6rUILzb.js";import"./index-BOtvnYjU.js";import"./index-CVyj0YhM.js";import"./core.esm-CS6-g6X4.js";const Tl=({tableName:_,operationFile:$,...de})=>{const{message:F}=ae.useApp(),h=c.useRef();c.useEffect(()=>{_&&(k(),B())},[_]);const[b,T]=c.useState([]),[D,w]=c.useState(),k=()=>{S.getTableColumn({table_name:_}).then(l=>{l.code===1?(T(l.data),w(Date.now())):F.error(l.message)})};c.useEffect(()=>{var l;if(m&&b.length>0){const a=[];for(let t in(l=m==null?void 0:m.react_create_update)==null?void 0:l.form_fileds_type)b.some(r=>{if(r.Field==t)return a.push(r),!0});b.map(t=>{var r,o;(o=(r=m==null?void 0:m.react_create_update)==null?void 0:r.form_fileds_type)!=null&&o[t.Field]||a.push(t)}),T(a)}},[D]);const[q,W]=c.useState([]),B=()=>{S.getTableList().then(l=>{l.code===1?W(l.data):F.error(l.message)})},[m,N]=c.useState({}),O=[{value:"Text",label:"文本输入"},{value:"Password",label:"密码输入"},{value:"TextArea",label:"多行文本输入"},{value:"Digit",label:"数字输入"},{value:"DigitRange",label:"数字区间输入"},{value:"DatePicker",label:"日期选择"},{value:"DateTimePicker",label:"日期+时间选择"},{value:"DateRangePicker",label:"日期区间选择"},{value:"DateTimeRangePicker",label:"日期+时间区间选择"},{value:"TimePicker",label:"时间选择"},{value:"TimePickerRange",label:"时间区间选择"},{value:"Select",label:"下拉"},{value:"TreeSelect",label:"树选择"},{value:"SelectTable",label:"异步搜索选择某个表的id"},{value:"Checkbox",label:"Checkbox多选"},{value:"Radio",label:"Radio单选"},{value:"Cascader",label:"Cascaderlian级联选择"},{value:"Switch",label:"Switch开关"},{value:"province",label:"省选择"},{value:"provinceCity",label:"省市选择"},{value:"provinceCityArea",label:"省市区选择"},{value:"tagArr",label:"tag数组"},{value:"imgTitle",label:"姓名+图片的数组"},{value:"tencentMap",label:"腾讯经纬度选择"},{value:"uploadFile",label:"上传单个文件"},{value:"uploadFileAll",label:"上传多个文件"},{value:"uploadImg",label:"上传单张图片"},{value:"uploadImgAll",label:"上传多张图片"},{value:"uploadImgVideoAll",label:"上传图片或视频"},{value:"teditor",label:"富文本编辑器"}],V=l=>e.jsx(P,{name:["react_create_update","form_fields_type_config",`${l}`,"addonBefore"],placeholder:"请输入...",fieldProps:{addonBefore:"前缀",style:{margin:"2px 0px"}}},"addonBefore"),G=l=>e.jsx(P,{name:["react_create_update","form_fields_type_config",`${l}`,"addonAfter"],placeholder:"请输入...",fieldProps:{addonBefore:"后缀",style:{margin:"2px 0px"}}},"addonAfter"),E=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"validateRules"],placeholder:"验证规则",options:[{label:"必填",value:"required"},{label:"URL链接",value:"url"},{label:"邮箱",value:"email"},{label:"手机号",value:"tel"},{label:"最小|长度",value:"min"},{label:"最大|长度",value:"max"},{label:"固定长度",value:"len"}],fieldProps:{popupMatchSelectWidth:!1,mode:"multiple",allowClear:!0,style:{margin:"2px 0px"}}},"validateRules"),L=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"dataSource"],placeholder:"请选择数据来源",options:[{label:"自己填写选择项",value:"options"},{label:"API请求选择项",value:"request"}],fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"}},rules:[{required:!0,message:"请选择"}]},"dataSource"),U=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"provinceCityAreaValueType"],placeholder:"选择后需要类型",options:[{label:"需要标题",value:"title"},{label:"需要ID",value:"id"}],fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"}},rules:[{required:!0,message:"请选择"}]},"provinceCityAreaValueType"),z=l=>e.jsxs("div",{children:[e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"selectMode"],placeholder:"是否多选",options:[{label:"多选multiple",value:"multiple"},{label:"多选加自定义输入tags",value:"tags"}],fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"}},rules:[]},"selectMode"),e.jsx(d,{name:[["react_create_update","form_fields_type_config",`${l}`,"selectMode"]],children:({react_create_update:a})=>{var r,o;if((o=(r=a==null?void 0:a.form_fields_type_config)==null?void 0:r[l])==null?void 0:o.selectMode)return e.jsx(j,{name:["react_create_update","form_fields_type_config",`${l}`,"maxCount"],placeholder:"最大选择条数",min:1,fieldProps:{addonBefore:"最多",style:{margin:"2px 0px"},addonAfter:"条",precision:0},rules:[]},"maxCountNumber")}},"maxCount")]},"selectModeWarp"),K=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"treeCheckable"],placeholder:"显示Checkbox",options:[{label:"显示Checkbox",value:"treeCheckable"}],fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"}},rules:[]},"treeCheckable"),H=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"cascaderMultiple"],placeholder:"是否多选",options:[{label:"cascaderMultiple",value:"cascaderMultiple"}],fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"}},rules:[]},"cascaderMultiple"),J=l=>e.jsx(d,{name:[["react_create_update","card_tab_list"],["react_create_update","open_type"]],children:({react_create_update:a})=>{const t=a==null?void 0:a.card_tab_list,r=a==null?void 0:a.open_type;if(r==2&&(t==null?void 0:t.length)>0)return e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"field_to_tab"],placeholder:"归属哪个tab里面",fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"}},params:{card_tab_list:t,open_type:r},request:async()=>t.map((o,s)=>({label:`归属tab：${o}`,value:s+1})),rules:[{required:!0,message:"请选择"}]},"field_to_tab")}},"field_to_tab"),Q=l=>e.jsx(P,{name:["react_create_update","form_fields_type_config",`${l}`,"fileSuffix"],placeholder:"请输入",fieldProps:{addonBefore:"允许文件后缀",style:{margin:"2px 0px"},addonAfter:e.jsx(ne,{title:"用英文逗号隔开如：ppt,docx",children:e.jsx(pe,{})})},rules:[{required:!0,message:"请输入"}]},"fileSuffix"),X=l=>e.jsx(j,{name:["react_create_update","form_fields_type_config",`${l}`,"maxUploadCount"],placeholder:"请输入",fieldProps:{addonBefore:"最大上传数量",style:{margin:"2px 0px"},precision:0},min:1},"maxUploadCount"),Y=l=>e.jsx(j,{name:["react_create_update","form_fields_type_config",`${l}`,"minNumber"],placeholder:"请输入",fieldProps:{addonBefore:"最小|长度",style:{margin:"2px 0px"},precision:0},min:1,rules:[{required:!0,message:"请输入"}]},"minNumber"),Z=l=>e.jsx(j,{name:["react_create_update","form_fields_type_config",`${l}`,"maxNumber"],placeholder:"请输入",fieldProps:{addonBefore:"最大|长度",style:{margin:"2px 0px"},precision:0},min:1,rules:[{required:!0,message:"请输入"}]},"maxNumber"),ee=l=>e.jsx(j,{name:["react_create_update","form_fields_type_config",`${l}`,"lenNumber"],placeholder:"请输入",fieldProps:{addonBefore:"固定|长度",style:{margin:"2px 0px"},precision:0},min:1,rules:[{required:!0,message:"请输入"}]},"lenNumber"),le=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"dependencyField"],placeholder:"当xx字段xx的时候才显示",request:async()=>b,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Field",label:"Field"},optionRender:a=>`关联字段：${a.label}`},extra:"关联字段：当xx字段xx的时候才显示",rules:[]},"dependencyField"),A=l=>e.jsx(n,{name:["react_create_update","form_fields_type_config",`${l}`,"dataSourceTable"],placeholder:"请选择数据来源",options:q,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},extra:"选择项数据来源表",rules:[{required:!0,message:"请选择"}]},"dataSourceTable");return e.jsxs(e.Fragment,{children:[e.jsx(x,{formRef:h,size:"small",params:{table_name:_},request:async l=>{const a=await S.getCodeGeneratorInfo(l);return N(a.data),w(Date.now()),a.data||{}},submitter:!1,onFinish:async l=>{S.generatorCode({react_create_update:{...l.react_create_update,file_name:"index",file_suffix:"jsx"},table_name:_,code_name:"react_create_update"}).then(a=>{if(a.code===1){if(F.success(a.message),h.current.setFieldValue("react_create_code",a.data.react_create_code),h.current.setFieldValue("react_update_code",a.data.react_update_code),a.data.react_form_code)for(let t in a.data.react_form_code)h.current.setFieldValue(["react_form_code",t],a.data.react_form_code[t])}else F.error(a.message)})},children:e.jsxs(te,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(M,{gutter:[24,0],children:[e.jsx(f,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(R.Group,{name:["react_create_update","open_type"],label:"打开类型",rules:[{required:!0,message:"请选择"}],options:[{label:"弹窗打开",value:1},{label:"新页面打开",value:2}]})}),e.jsx(f,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(R.Group,{name:["react_create_update","update_page"],label:"是否需要更新页面",rules:[{required:!0,message:"请选择"}],options:[{label:"需要",value:1},{label:"不需要",value:2}],extra:"如简单的列表而且是可编辑的Table就不需要"})}),e.jsx(f,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(n,{name:["react_create_update","row_columns_number"],label:"每行显示几个字段",placeholder:"请选择",rules:[{required:!0,message:"请选择"}],options:[{label:"1个",value:1},{label:"2个",value:2},{label:"3个",value:3},{label:"4个",value:4}]})}),e.jsx(d,{name:[["react_create_update","open_type"]],children:({react_create_update:l})=>{if((l==null?void 0:l.open_type)==2)return e.jsx(f,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(n,{name:["react_create_update","card_tab_list"],label:"多标签Tab的form",placeholder:"请输入",fieldProps:{mode:"tags"},extra:"直接输入tab的名称",rules:[]})})}},"1")]}),e.jsx(re,{className:"generator-create-update-from",ghost:!0,columns:[{title:"排序",dataIndex:"sort",width:50},{title:"字段",width:200,dataIndex:"Field"},{title:"类型",width:120,dataIndex:"Type"},{title:"默认值",dataIndex:"Default",width:70,render:(l,a)=>a.Default?a.Default:a.Default===null?"null":""},{title:"注释",dataIndex:"Comment",ellipsis:!0},{title:"字段名称",dataIndex:"field_title"},{title:"表单字段类型",dataIndex:"form_fileds_type",render:(l,a)=>e.jsx(e.Fragment,{children:e.jsx(n,{name:["react_create_update","form_fileds_type",`${a.Field}`],placeholder:"请选择",request:async()=>O,fieldProps:{showSearch:!0,popupMatchSelectWidth:!1}})})},{title:"字段配置",dataIndex:"form_fields_type_config",width:350,render:(l,a)=>e.jsxs(e.Fragment,{children:[e.jsx(d,{name:[["react_create_update","form_fileds_type",a.Field]],children:({react_create_update:t})=>{var r,o;if((r=t==null?void 0:t.form_fileds_type)!=null&&r[a.Field]){const s=(o=t==null?void 0:t.form_fileds_type)==null?void 0:o[a.Field],i=[];return i.push(E(a.Field)),(s=="Text"||s=="Digit")&&(i.push(V(a.Field)),i.push(G(a.Field))),["Select","TreeSelect","Checkbox","Radio","Cascader"].indexOf(s)!==-1&&(i.push(L(a.Field)),i.push(e.jsx(d,{name:[["react_create_update","form_fields_type_config",a.Field,"dataSource"]],children:({react_create_update:u})=>{var g,y;const p=(y=(g=u==null?void 0:u.form_fields_type_config)==null?void 0:g[a.Field])==null?void 0:y.dataSource;if(p&&p=="request")return A(a.Field)}},"2"))),["SelectTable"].indexOf(s)!==-1&&i.push(A(a.Field)),["uploadFile","uploadFileAll"].indexOf(s)!==-1&&i.push(Q(a.Field)),["uploadImgAll","uploadFileAll","uploadImgVideoAll"].indexOf(s)!==-1&&i.push(X(a.Field)),i.push(e.jsx(d,{name:[["react_create_update","form_fields_type_config",a.Field,"validateRules"]],children:({react_create_update:u})=>{var g,y;const p=(y=(g=u==null?void 0:u.form_fields_type_config)==null?void 0:g[a.Field])==null?void 0:y.validateRules;if(Array.isArray(p)&&p.length>0){const C=[];return p.indexOf("min")!==-1&&C.push(Y(a.Field)),p.indexOf("max")!==-1&&C.push(Z(a.Field)),p.indexOf("len")!==-1&&C.push(ee(a.Field)),C}}},"1")),s=="Select"&&i.push(z(a.Field)),s=="TreeSelect"&&i.push(K(a.Field)),s=="Cascader"&&i.push(H(a.Field)),["province","provinceCity","provinceCityArea"].indexOf(s)!==-1&&i.push(U(a.Field)),i.push(le(a.Field)),i.push(J(a.Field)),i}return""}}),e.jsx(P,{name:["react_create_update","form_fields_type_config",`${a.Field}`,"extra"],placeholder:"字段提示信息",fieldProps:{style:{margin:"2px 0px"}}})]})}],rowKey:"Field",search:!1,pagination:!1,options:!1,defaultSize:"small",bordered:!0,dragSortKey:"sort",onDragSortEnd:(l,a,t)=>{T(t)},dataSource:b}),e.jsx(d,{name:[["react_create_update","update_page"]],children:({react_create_update:l})=>(l==null?void 0:l.update_page)==1?e.jsx(e.Fragment,{children:e.jsxs(M,{gutter:[24,0],children:[e.jsx(f,{span:12,children:e.jsx(x.Item,{name:"react_create_code",label:"新增页面代码",children:e.jsx(v,{})})}),e.jsx(f,{span:12,children:e.jsx(x.Item,{name:"react_update_code",label:"更新页面代码",children:e.jsx(v,{})})})]})}):e.jsx(e.Fragment,{children:e.jsx(x.Item,{name:"react_create_code",label:"新增页面代码",children:e.jsx(v,{})})})}),e.jsx(d,{name:[["react_create_update","card_tab_list"],["react_create_update","open_type"]],children:({react_create_update:l})=>{const a=l==null?void 0:l.open_type,t=l==null?void 0:l.card_tab_list;return a==2&&(t==null?void 0:t.length)>0?t.map((r,o)=>e.jsx(x.Item,{name:["react_form_code",`${o+1}`],label:`Form字段：${r}`,children:e.jsx(v,{})},o)):e.jsx(x.Item,{name:["react_form_code","1"],label:"Form字段代码",children:e.jsx(v,{})})}})]})}),e.jsx(ie,{offsetBottom:10,children:e.jsx(oe,{boxShadow:!0,children:e.jsxs(se,{align:"center",justify:"center",gap:"small",children:[e.jsx(I,{type:"primary",size:"default",onClick:()=>{h.current.submit()},children:"保存设置》生成预览代码"}),e.jsx(I,{danger:!0,onClick:()=>{$("react_create_update")},children:"生成到项目"})]})})})]})};export{Tl as default};
