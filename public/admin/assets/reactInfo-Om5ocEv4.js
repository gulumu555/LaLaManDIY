import{A as D,r as a,j as e,B as j}from"./index-CxoETvRH.js";import{a as d}from"./adminCodeGenerator-o3VPck0b.js";import{C as W}from"./index-vDDUv-ak.js";import{S as q}from"./index-BphrQzO9.js";import{R as G,C as n}from"./row-qzGwq4Dr.js";import{W as _}from"./index-DqNJzPla.js";import{P as u}from"./index-DsYJmDxZ.js";import{W as f}from"./index-w3B4RVYE.js";import{W as v}from"./index-B5gW4Hci.js";import{D as A}from"./index-DUMZawVF.js";import{A as N}from"./index-CKDIzB68.js";import{P as R}from"./ProCard-D6QkQ_g5.js";import{F as B}from"./index-DZIFP8d9.js";import{P as y}from"./index-BV5Zm_mO.js";import{I as E}from"./BaseForm-Ce_dWbWI.js";import{P as L}from"./index-CVCROCWL.js";import"./index-DdonXCdW.js";import"./EditOutlined-DSBmrQxq.js";import"./index-C-0gitmI.js";import"./styleChecker-BWYb9pEX.js";import"./TextArea-B06lod9y.js";import"./getAllowClear-61dfOySQ.js";import"./CheckOutlined-DNlRZmOM.js";import"./CopyOutlined-DoMFKUVx.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-9N_aLd03.js";import"./addEventListener-DSaIWks1.js";import"./Overflow-C1Gv4RUW.js";import"./iconUtil-CrL5XMUw.js";import"./index-BbWS0DN_.js";import"./PurePanel-Qn0-6z3A.js";import"./move-BEwii-fV.js";import"./DownOutlined-CKTuMrT9.js";import"./Input-DBs5aIW3.js";import"./index-BCcQRwwP.js";import"./index-DPelJOqh.js";import"./index-CvzSf1Bg.js";import"./index-C_bV-DnG.js";import"./index-Bcl-gWmM.js";import"./index-4oTavk15.js";import"./LeftOutlined-CXR1ue2q.js";import"./index-BiKlR4w8.js";import"./progress-Ofxp_QxA.js";import"./index-r-JVz4Yx.js";import"./index-BZDhPRiF.js";import"./Table-MBA0ODj2.js";import"./index-EKub9ikS.js";import"./Table-dye4hUJ0.js";import"./index-D0fE36s2.js";import"./dropdown-0heBmOdg.js";import"./Dropdown-B_0_MLsu.js";import"./index-27J4tOGW.js";import"./EllipsisOutlined-DYRNvKIw.js";import"./Sider-DIX9tLFZ.js";import"./index-DRn2fARs.js";import"./HolderOutlined-c3sLJRZN.js";import"./CaretDownOutlined-Cm7GLJFD.js";import"./index-0Umo49A8.js";import"./index-CHnZ-yQ1.js";import"./index-JNVvr94D.js";import"./index-lKg4xbVK.js";import"./index-lhHkabfZ.js";import"./index-Dx6Z95tT.js";import"./index-B6rUILzb.js";import"./index-BOtvnYjU.js";import"./index-CVyj0YhM.js";import"./PlusOutlined-vk23tUE5.js";import"./core.esm-CS6-g6X4.js";import"./DeleteOutlined-CBiNWy3g.js";const rt=({tableName:i,operationFile:w,...k})=>{const{message:m}=D.useApp(),c=a.useRef();a.useEffect(()=>{i&&(P(),C())},[i]);const[p,x]=a.useState([]),[F,h]=a.useState(),P=()=>{d.getTableColumn({table_name:i}).then(t=>{t.code===1?(x(t.data),h(Date.now())):m.error(t.message)})};a.useEffect(()=>{var t;if(o&&p.length>0){const r=[];for(let l in(t=o==null?void 0:o.react_info)==null?void 0:t.info_fields_type)p.some(s=>{if(s.Field==l)return r.push(s),!0});p.map(l=>{var s,g;(g=(s=o==null?void 0:o.react_info)==null?void 0:s.info_fields_type)!=null&&g[l.Field]||r.push(l)}),x(r)}},[F]);const[b,S]=a.useState([]),C=()=>{d.getTableList().then(t=>{t.code===1?S(t.data):m.error(t.message)})},[o,I]=a.useState({}),T=[{value:"text",label:"文本"},{value:"text_ellipsis",label:"文本可展开"},{value:"status",label:"状态如订单状态"},{value:"text_copy",label:"可复制文本"},{value:"text_secondary",label:"灰色文本"},{value:"text_success",label:"绿色文本"},{value:"text_warning",label:"黄色文本"},{value:"text_danger",label:"红色文本"},{value:"text_strong",label:"加粗文本"},{value:"text_mark",label:"黄色底文本"},{value:"text_code",label:"灰色底文本"},{value:"preview_content",label:"弹窗查看文本"},{value:"preview_images_videos",label:"预览多个图片或视频"},{value:"preview_teditor",label:"预览富文本内容"},{value:"preview_video",label:"预览视频"},{value:"preview_pdf",label:"预览pdf"},{value:"preview_word",label:"预览word"}];return e.jsxs(e.Fragment,{children:[e.jsx(y,{formRef:c,size:"small",params:{table_name:i},request:async t=>{const r=await d.getCodeGeneratorInfo(t);return I(r.data),h(Date.now()),r.data||{}},submitter:!1,onFinish:async t=>{d.generatorCode({react_info:{...t.react_info,file_name:"index",file_suffix:"jsx"},table_name:i,code_name:"react_info"}).then(r=>{r.code===1?(m.success(r.message),c.current.setFieldValue("react_info_code",r.data.react_info_code)):m.error(r.message)})},children:e.jsxs(q,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(G,{gutter:[24,0],children:[e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(_.Group,{name:["react_info","info_open_type"],label:"打开类型",rules:[{required:!0,message:"请选择"}],options:[{label:"新页面打开",value:1},{label:"弹窗打开",value:2}]})}),e.jsx(u,{name:[["react_info","info_open_type"]],children:({react_info:t})=>{if((t==null?void 0:t.info_open_type)==2)return e.jsx(e.Fragment,{children:e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(f,{name:["react_info","row_columns_number"],label:"弹窗每行显示几个字段",placeholder:"请选择",rules:[{required:!0,message:"请选择"}],options:[{label:"1个",value:1},{label:"2个",value:2},{label:"3个",value:3},{label:"4个",value:4}]})})})}}),e.jsx(u,{name:[["react_info","info_open_type"]],children:({react_info:t})=>{if((t==null?void 0:t.info_open_type)==1)return e.jsxs(e.Fragment,{children:[e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(_.Group,{name:["react_info","bottom_action"],label:"引入底部操作栏",rules:[],options:[{label:"否",value:1},{label:"是",value:2}]})}),e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(_.Group,{name:["react_info","right_timeline"],label:"右边引入时间轴",rules:[],options:[{label:"否",value:1},{label:"是",value:2}],extra:"将显示在页面的右边"})}),e.jsx(u,{name:[["react_info","right_timeline"]],children:({react_info:l})=>{if((l==null?void 0:l.right_timeline)==2)return e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(f,{name:["react_info","right_timeline_apiFileName"],label:"时间轴数据来源",placeholder:"请选择数据来源",options:b,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},rules:[{required:!0,message:"请选择"}]})})}})]})}})]}),e.jsx(u,{name:[["react_info","info_open_type"]],children:({react_info:t})=>{if((t==null?void 0:t.info_open_type)==1)return e.jsx(e.Fragment,{children:e.jsx(E,{name:["react_info","table_list"],label:"添加ProTable",creatorButtonProps:{creatorButtonText:"添加Table"},children:e.jsxs(L,{children:[e.jsx(v,{name:"name",label:"Table名称",placeholder:"请输入",rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}}),e.jsx(f,{name:"apiFileName",label:"数据请求接口",placeholder:"请选择数据来源",options:b,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},rules:[{required:!0,message:"请选择"}]}),e.jsx(v,{name:"apiFileName_action",label:"数据请求方法名",placeholder:"请输入",rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}})]})})})}}),e.jsx(A,{className:"generator-create-info-from",ghost:!0,columns:[{title:"排序",dataIndex:"sort",width:50},{title:"字段",width:200,dataIndex:"Field"},{title:"类型",width:120,dataIndex:"Type"},{title:"默认值",dataIndex:"Default",width:70,render:(t,r)=>r.Default?r.Default:r.Default===null?"null":""},{title:"注释",dataIndex:"Comment",ellipsis:!0},{title:"字段名称",dataIndex:"field_title"},{title:"字段展示类型",dataIndex:"info_fields_type",render:(t,r)=>e.jsx(e.Fragment,{children:e.jsx(f,{name:["react_info","info_fields_type",`${r.Field}`],placeholder:"请选择",request:async()=>T,fieldProps:{showSearch:!0,popupMatchSelectWidth:!1}})})}],rowKey:"Field",search:!1,pagination:!1,options:!1,defaultSize:"small",bordered:!0,dragSortKey:"sort",onDragSortEnd:(t,r,l)=>{x(l)},dataSource:p}),e.jsx(y.Item,{name:"react_info_code",children:e.jsx(W,{})})]})}),e.jsx(N,{offsetBottom:10,children:e.jsx(R,{boxShadow:!0,children:e.jsxs(B,{align:"center",justify:"center",gap:"small",children:[e.jsx(j,{type:"primary",size:"default",onClick:()=>{c.current.submit()},children:"保存设置》生成预览代码"}),e.jsx(j,{danger:!0,onClick:()=>{w("react_info")},children:"生成到项目"})]})})})]})};export{rt as default};
