import{A as D,r as a,j as e,B as j}from"./index-ZI51y314.js";import{a as d}from"./adminCodeGenerator-1uF-yRli.js";import{C as W}from"./index-D3ASoVtW.js";import{S as q}from"./index-DFWIh5En.js";import{R as G,C as n}from"./row-CA0HzO8K.js";import{W as _}from"./index-B_xJYOvO.js";import{P as u}from"./index-B_vyTJVd.js";import{W as f}from"./index-jrhCuYmp.js";import{W as v}from"./index-D4bfMQDp.js";import{D as A}from"./index-DnKcHXc3.js";import{A as N}from"./index-DdgniWrL.js";import{P as R}from"./ProCard-CQJ5thSX.js";import{F as B}from"./index-D9hSwQuV.js";import{P as y}from"./index-ClH-H18i.js";import{I as E}from"./BaseForm-Dt9roNn_.js";import{P as L}from"./index-Cqf3aS8y.js";import"./index-Ig2XVJMn.js";import"./EditOutlined-C2XE2Of8.js";import"./index-BIgUuT9u.js";import"./styleChecker-nFJfeipz.js";import"./TextArea-CbhGwHw0.js";import"./getAllowClear-Bb8ihI2F.js";import"./CheckOutlined-BH5QPYjn.js";import"./CopyOutlined-Di_ABAcP.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-LlaO7o8U.js";import"./addEventListener-2k7hxYrj.js";import"./Overflow-6EGZ5_au.js";import"./iconUtil-snskxn8a.js";import"./index-C4Es4GTO.js";import"./PurePanel-IzJJVpwi.js";import"./move-D1aXciBO.js";import"./DownOutlined-BvFNYu2h.js";import"./Input-YyHXjDeB.js";import"./index-B94rXkjj.js";import"./index-BQOafed3.js";import"./index-Dm2ANYsS.js";import"./index-DPgpDBVC.js";import"./index-DxRnNHO_.js";import"./index-CzgBx6dd.js";import"./LeftOutlined-DLD2DGED.js";import"./index-D32vO3So.js";import"./progress-DyKaNkG9.js";import"./index-CJ6fB5dR.js";import"./index-Bo_cWNs1.js";import"./Table-B6v6YKM6.js";import"./index-Cl5zAUSu.js";import"./Table-DRKnGQZA.js";import"./index-DbzUeGO6.js";import"./dropdown-CBTinjep.js";import"./Dropdown-D-H8baFE.js";import"./index-YSn64RDr.js";import"./EllipsisOutlined-rOnf-sW7.js";import"./Sider-BPr4VxAy.js";import"./index-BWfJjs86.js";import"./HolderOutlined-51iibq6a.js";import"./CaretDownOutlined-902wn7sG.js";import"./index-0LiqU0NK.js";import"./index-AV8iSHwq.js";import"./index-Cn0WBpt6.js";import"./index-CqBDmXPg.js";import"./index-lhHkabfZ.js";import"./index-DWBnXa5p.js";import"./index-DujqzdOS.js";import"./index-rQeGZp6R.js";import"./index-DuZOyzfN.js";import"./PlusOutlined-BrSmXzHo.js";import"./core.esm-uR2lXNm7.js";import"./DeleteOutlined-BJQ6Ec5G.js";const rt=({tableName:i,operationFile:w,...k})=>{const{message:m}=D.useApp(),c=a.useRef();a.useEffect(()=>{i&&(P(),C())},[i]);const[p,x]=a.useState([]),[F,h]=a.useState(),P=()=>{d.getTableColumn({table_name:i}).then(t=>{t.code===1?(x(t.data),h(Date.now())):m.error(t.message)})};a.useEffect(()=>{var t;if(o&&p.length>0){const r=[];for(let l in(t=o==null?void 0:o.react_info)==null?void 0:t.info_fields_type)p.some(s=>{if(s.Field==l)return r.push(s),!0});p.map(l=>{var s,g;(g=(s=o==null?void 0:o.react_info)==null?void 0:s.info_fields_type)!=null&&g[l.Field]||r.push(l)}),x(r)}},[F]);const[b,S]=a.useState([]),C=()=>{d.getTableList().then(t=>{t.code===1?S(t.data):m.error(t.message)})},[o,I]=a.useState({}),T=[{value:"text",label:"文本"},{value:"text_ellipsis",label:"文本可展开"},{value:"status",label:"状态如订单状态"},{value:"text_copy",label:"可复制文本"},{value:"text_secondary",label:"灰色文本"},{value:"text_success",label:"绿色文本"},{value:"text_warning",label:"黄色文本"},{value:"text_danger",label:"红色文本"},{value:"text_strong",label:"加粗文本"},{value:"text_mark",label:"黄色底文本"},{value:"text_code",label:"灰色底文本"},{value:"preview_content",label:"弹窗查看文本"},{value:"preview_images_videos",label:"预览多个图片或视频"},{value:"preview_teditor",label:"预览富文本内容"},{value:"preview_video",label:"预览视频"},{value:"preview_pdf",label:"预览pdf"},{value:"preview_word",label:"预览word"}];return e.jsxs(e.Fragment,{children:[e.jsx(y,{formRef:c,size:"small",params:{table_name:i},request:async t=>{const r=await d.getCodeGeneratorInfo(t);return I(r.data),h(Date.now()),r.data||{}},submitter:!1,onFinish:async t=>{d.generatorCode({react_info:{...t.react_info,file_name:"index",file_suffix:"jsx"},table_name:i,code_name:"react_info"}).then(r=>{r.code===1?(m.success(r.message),c.current.setFieldValue("react_info_code",r.data.react_info_code)):m.error(r.message)})},children:e.jsxs(q,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(G,{gutter:[24,0],children:[e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(_.Group,{name:["react_info","info_open_type"],label:"打开类型",rules:[{required:!0,message:"请选择"}],options:[{label:"新页面打开",value:1},{label:"弹窗打开",value:2}]})}),e.jsx(u,{name:[["react_info","info_open_type"]],children:({react_info:t})=>{if((t==null?void 0:t.info_open_type)==2)return e.jsx(e.Fragment,{children:e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(f,{name:["react_info","row_columns_number"],label:"弹窗每行显示几个字段",placeholder:"请选择",rules:[{required:!0,message:"请选择"}],options:[{label:"1个",value:1},{label:"2个",value:2},{label:"3个",value:3},{label:"4个",value:4}]})})})}}),e.jsx(u,{name:[["react_info","info_open_type"]],children:({react_info:t})=>{if((t==null?void 0:t.info_open_type)==1)return e.jsxs(e.Fragment,{children:[e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(_.Group,{name:["react_info","bottom_action"],label:"引入底部操作栏",rules:[],options:[{label:"否",value:1},{label:"是",value:2}]})}),e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(_.Group,{name:["react_info","right_timeline"],label:"右边引入时间轴",rules:[],options:[{label:"否",value:1},{label:"是",value:2}],extra:"将显示在页面的右边"})}),e.jsx(u,{name:[["react_info","right_timeline"]],children:({react_info:l})=>{if((l==null?void 0:l.right_timeline)==2)return e.jsx(n,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(f,{name:["react_info","right_timeline_apiFileName"],label:"时间轴数据来源",placeholder:"请选择数据来源",options:b,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},rules:[{required:!0,message:"请选择"}]})})}})]})}})]}),e.jsx(u,{name:[["react_info","info_open_type"]],children:({react_info:t})=>{if((t==null?void 0:t.info_open_type)==1)return e.jsx(e.Fragment,{children:e.jsx(E,{name:["react_info","table_list"],label:"添加ProTable",creatorButtonProps:{creatorButtonText:"添加Table"},children:e.jsxs(L,{children:[e.jsx(v,{name:"name",label:"Table名称",placeholder:"请输入",rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}}),e.jsx(f,{name:"apiFileName",label:"数据请求接口",placeholder:"请选择数据来源",options:b,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},rules:[{required:!0,message:"请选择"}]}),e.jsx(v,{name:"apiFileName_action",label:"数据请求方法名",placeholder:"请输入",rules:[{required:!0,message:"请输入"}],fieldProps:{style:{width:180}}})]})})})}}),e.jsx(A,{className:"generator-create-info-from",ghost:!0,columns:[{title:"排序",dataIndex:"sort",width:50},{title:"字段",width:200,dataIndex:"Field"},{title:"类型",width:120,dataIndex:"Type"},{title:"默认值",dataIndex:"Default",width:70,render:(t,r)=>r.Default?r.Default:r.Default===null?"null":""},{title:"注释",dataIndex:"Comment",ellipsis:!0},{title:"字段名称",dataIndex:"field_title"},{title:"字段展示类型",dataIndex:"info_fields_type",render:(t,r)=>e.jsx(e.Fragment,{children:e.jsx(f,{name:["react_info","info_fields_type",`${r.Field}`],placeholder:"请选择",request:async()=>T,fieldProps:{showSearch:!0,popupMatchSelectWidth:!1}})})}],rowKey:"Field",search:!1,pagination:!1,options:!1,defaultSize:"small",bordered:!0,dragSortKey:"sort",onDragSortEnd:(t,r,l)=>{x(l)},dataSource:p}),e.jsx(y.Item,{name:"react_info_code",children:e.jsx(W,{})})]})}),e.jsx(N,{offsetBottom:10,children:e.jsx(R,{boxShadow:!0,children:e.jsxs(B,{align:"center",justify:"center",gap:"small",children:[e.jsx(j,{type:"primary",size:"default",onClick:()=>{c.current.submit()},children:"保存设置》生成预览代码"}),e.jsx(j,{danger:!0,onClick:()=>{w("react_info")},children:"生成到项目"})]})})})]})};export{rt as default};
