import{A as K,r as o,m as H,j as e,B as $}from"./index-BTXTJVKt.js";import{a as c}from"./adminCodeGenerator-XA6WtBhQ.js";import{a as O}from"./adminMenu-Hr-Zrko8.js";import{C as Q}from"./index-BMfK2Dip.js";import{S as V}from"./index-B1B7dhZb.js";import{R as Y,C as _}from"./row-DJNm5-9Y.js";import{W as s}from"./index-CNcHXf2n.js";import{P as d}from"./index-Cpu1JcVa.js";import{W}from"./index-2DT4l-EF.js";import{D as J}from"./index-Dwni2OoB.js";import{A as U}from"./index-C1Zz-ieJ.js";import{P as X}from"./ProCard-BTx7yLUQ.js";import{F as Z}from"./index-BGu4eHBl.js";import{P as A}from"./index-D_n6I86r.js";import{I as ee}from"./BaseForm-Bt-x2uS5.js";import{P as le}from"./index-DWwHrh8G.js";import"./index-Dx9hPCiE.js";import"./EditOutlined-Jb-cOsu8.js";import"./index-DWyRM-jO.js";import"./styleChecker-xca8e-q0.js";import"./TextArea-Dm9DBQS4.js";import"./getAllowClear-SV9Asyat.js";import"./CheckOutlined-CRheHqkM.js";import"./CopyOutlined-Bqo58qRo.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-C9P5ZgXD.js";import"./index-DwWsiyHK.js";import"./index-BaexhYUL.js";import"./index-CsweGtVO.js";import"./DownOutlined-dHMiLU6h.js";import"./index-CBjIPB84.js";import"./addEventListener-BQxGY-6f.js";import"./Overflow-DodMVMUF.js";import"./iconUtil-0otcsGdb.js";import"./index-D1w3VCkm.js";import"./PurePanel-BJ0dSvru.js";import"./move-BiL2XrK1.js";import"./Input-CJszbmX7.js";import"./index-Ci-Y97rG.js";import"./index-DZ2tAw4A.js";import"./LeftOutlined-CNJksXTb.js";import"./index-Wn9_u9d6.js";import"./progress-C-smal5r.js";import"./index-BfhOKpHw.js";import"./index-D5nMW6Hn.js";import"./Table-CUXyCVLs.js";import"./index-ZV6Sdybn.js";import"./Table-ButWyQXY.js";import"./index-Clo_9DB7.js";import"./dropdown-ozNz9IXP.js";import"./Dropdown-D-FCcTPI.js";import"./index-D2NRD51k.js";import"./EllipsisOutlined-BzWcE7tF.js";import"./Sider-clMwekzu.js";import"./index-B9ywFgu1.js";import"./HolderOutlined-DO80hp-F.js";import"./CaretDownOutlined-BWLnnrSk.js";import"./index-Dnt0D-Vv.js";import"./index-DiR_3Q38.js";import"./index-Ck2b4VHc.js";import"./index-hKAX5Tgp.js";import"./index-lhHkabfZ.js";import"./index-CcMUfAok.js";import"./index-1Ew_B_KM.js";import"./index-JJDTxIwy.js";import"./index-CHGWkdWj.js";import"./PlusOutlined-DhDAnJdR.js";import"./core.esm-Ds3LvBvm.js";import"./DeleteOutlined-sMe1csST.js";const vl=({tableName:n,operationFile:M,...te})=>{const{message:u}=K.useApp(),f=o.useRef();o.useEffect(()=>{n&&(q(),B(),R())},[n]);const[m,h]=o.useState([]),[L,g]=o.useState(),q=()=>{c.getTableColumn({table_name:n}).then(t=>{t.code===1?(h(t.data),g(Date.now())):u.error(t.message)})};o.useEffect(()=>{var t;if(p&&m.length>0){const a=[];for(let l in(t=p==null?void 0:p.react_list)==null?void 0:t.list_fields_type)m.some(r=>{if(r.Field==l)return a.push(r),!0});m.map(l=>{var r,i;(i=(r=p==null?void 0:p.react_list)==null?void 0:r.list_fields_type)!=null&&i[l.Field]||a.push(l)}),h(a)}},[L]);const[y,N]=o.useState([]),R=()=>{c.getTableList().then(t=>{t.code===1?N(t.data):u.error(t.message)})},[j,k]=o.useState([]),B=()=>{O.getList({hidden:"all"}).then(t=>{t.code===1&&k(H(t.data))})},[p,E]=o.useState({}),G=[{value:"text",label:"常规文本"},{value:"text_link",label:"可点击链接"},{value:"image",label:"图片"},{value:"name_tel_copy",label:"姓名/手机号(可复制)"},{value:"name_age_sex",label:"姓名/年龄/性别"},{value:"tag",label:"Tag标签"},{value:"avatar",label:"头像"},{value:"user",label:"头像/姓名/手机号"},{value:"money",label:"金额"},{value:"money_line",label:"多行的金额"},{value:"typography_text",label:"Typography文字"},{value:"switch",label:"状态开关可切换"},{value:"status_type",label:"多颜色状态/类型"},{value:"sort",label:"排序"},{value:"progress",label:"进度条"},{value:"descriptions",label:"弹窗用Descriptions描述列表"},{value:"preview_text",label:"弹窗查看文本"},{value:"preview_teditor",label:"预览富文本内容"},{value:"preview_images_videos",label:"预览多图或视频"},{value:"preview_video",label:"预览视频"},{value:"preview_pdf",label:"预览pdf"},{value:"preview_word",label:"预览word"},{value:"create_time",label:"添加时间"}],z=[{label:"Text",value:"text"},{label:"日期区间",value:"dateRange"},{label:"下拉",value:"select"},{label:"树形下拉框",value:"treeSelect"},{label:"级联选择器",value:"cascader"},{label:"异步搜索选择某个表的id",value:"selectTable"},{label:"选择日期",value:"date"},{label:"省选择",value:"province"},{label:"省市选择",value:"provinceCity"},{label:"省市区选择",value:"provinceCityArea"},{label:"选择日期时间",value:"dateTime"},{label:"选择周",value:"dateWeek"},{label:"选择月",value:"dateMonth"},{label:"选择季度",value:"dateQuarter"},{label:"选择年",value:"dateYear"},{label:"日期时间区间",value:"dateTimeRange"},{label:"选择时间",value:"time"},{label:"时间区间",value:"timeRange"},{label:"单选框",value:"radio"},{label:"多选框",value:"checkbox"}];return e.jsxs(e.Fragment,{children:[e.jsx(A,{formRef:f,size:"small",params:{table_name:n},request:async t=>{const a=await c.getCodeGeneratorInfo(t);return E(a.data),g(Date.now()),a.data||{}},submitter:!1,onFinish:async t=>{c.generatorCode({react_list:{...t.react_list,file_name:"index",file_suffix:"jsx"},table_name:n,code_name:"react_list"}).then(a=>{a.code===1?(u.success(a.message),f.current.setFieldValue("react_list_code",a.data.react_list_code)):u.error(a.message)})},children:e.jsxs(V,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(Y,{gutter:[24,0],children:[e.jsx(_,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(s,{name:["react_list","table_type"],label:"页面类型",placeholder:"请选择",options:[{value:1,label:"常规列表"},{value:2,label:"一个字段的配置列表"}],rules:[{required:!0,message:"请选择"}]})}),e.jsx(d,{name:[["react_list","table_type"]],children:({react_list:t})=>{if((t==null?void 0:t.table_type)==1)return e.jsxs(e.Fragment,{children:[e.jsx(_,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(s,{name:["react_list","card_tabs_list"],label:"顶部的tabs",placeholder:"请输入",fieldProps:{mode:"tags"},rules:[],extra:"是否引入card的多Tabs，直接输入tab的名称"})}),e.jsx(d,{name:[["react_list","card_tabs_list"]],children:({react_list:a})=>{let l=a==null?void 0:a.card_tabs_list;if(Array.isArray(l)&&l.length>1)return e.jsx(_,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(W,{name:["react_list","card_tabs_list_auth_id"],label:"顶部tabs的权限节点",placeholder:"请选择",rules:[],fieldProps:{showSearch:!0,multiple:!0,treeNodeFilterProp:"title",treeData:j,fieldNames:{lable:"title",value:"name"}},extra:"tabs的第一个不要权限，这只需按顺序选择后面几个的权限"})})}}),e.jsx(_,{xs:24,sm:12,md:12,lg:8,xl:6,xxl:6,children:e.jsx(s,{name:["react_list","table_action_list"],label:"列表的操作",placeholder:"请选择",fieldProps:{mode:"multiple"},options:[{value:"create",label:"添加"},{value:"update",label:"修改"},{value:"delete",label:"删除"},{value:"info",label:"详情"},{value:"export",label:"导出"},{value:"import",label:"导入"},{value:"all_delete",label:"批量删除"},{value:"all_update_status",label:"批量上下架(有状态修改才选择)"}],rules:[]})})]})}})]}),e.jsx(ee,{name:["react_list","table_action_all_list"],label:"批量修改的操作",creatorButtonProps:{creatorButtonText:"添加批量操作"},extra:"要批量修改的字段，最好在表设置里面已设置中文名，然后在添加修改页面设置里面已设置表单字段类型，否则生成的字段表单会统一为Text",children:e.jsxs(le,{children:[e.jsx(s,{name:"field",label:"批量修改的字段",placeholder:"请选择",options:m,rules:[{required:!0,message:"请选择"}],fieldProps:{style:{width:"200px"},popupMatchSelectWidth:!1,fieldNames:{value:"Field",label:"field_title"}}}),e.jsx(W,{name:["update_field_auth_id"],label:"此操作的权限节点",placeholder:"请选择",rules:[{required:!0,message:"请选择"}],fieldProps:{style:{width:"200px"},popupMatchSelectWidth:!1,showSearch:!0,treeNodeFilterProp:"title",treeData:j,fieldNames:{lable:"title",value:"name"}}})]})}),e.jsx(d,{name:[["react_list","table_type"]],children:({react_list:t})=>{if((t==null?void 0:t.table_type)==1)return e.jsx(e.Fragment,{children:e.jsx(J,{className:"generator-create-list-from",ghost:!0,columns:[{title:"排序",dataIndex:"sort",width:50},{title:"字段",width:200,dataIndex:"Field"},{title:"类型",width:120,dataIndex:"Type"},{title:"默认值",dataIndex:"Default",width:70,render:(a,l)=>l.Default?l.Default:l.Default===null?"null":""},{title:"注释",dataIndex:"Comment",ellipsis:!0},{title:"字段名称",dataIndex:"field_title"},{title:"字段展示类型",dataIndex:"list_fields_type",render:(a,l)=>e.jsx(e.Fragment,{children:e.jsx(s,{name:["react_list","list_fields_type",`${l.Field}`],placeholder:"请选择",request:async()=>G,fieldProps:{showSearch:!0,popupMatchSelectWidth:!1}})})},{title:"其它配置",dataIndex:"list_fields_type_config",render:(a,l)=>e.jsx(e.Fragment,{children:e.jsx(d,{name:[["react_list","list_fields_type",`${l.Field}`]],children:({react_list:r})=>{var F;let i=[];return((F=r==null?void 0:r.list_fields_type)==null?void 0:F[l.Field])=="text"&&(i.push(e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"ellipsis"],placeholder:"是否自动省略",rules:[],options:[{value:!0,label:"自动省略"},{value:!1,label:"不自动省略"}],fieldProps:{style:{margin:"2px 0px"}}},"ellipsis")),i.push(e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"copyable"],placeholder:"是否支持复制",rules:[],options:[{value:!0,label:"支持复制"},{value:!1,label:"不支持复制"}],fieldProps:{style:{margin:"2px 0px"}}},"copyable"))),i.push(e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"sorter"],placeholder:"是否支持排序",rules:[],options:[{value:!0,label:"支持排序"},{value:!1,label:"不支持排序"}],fieldProps:{style:{margin:"2px 0px"}}},"sorter")),i.push(e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"search"],placeholder:"是否支持搜索",rules:[],options:[{value:!0,label:"支持搜索"},{value:!1,label:"不支持搜索"}],fieldProps:{style:{margin:"2px 0px"}}},"search")),i.push(e.jsx(d,{name:[["react_list","list_fields_type_config",`${l.Field}`,"search"]],children:({react_list:x})=>{var w,P;if(((P=(w=x==null?void 0:x.list_fields_type_config)==null?void 0:w[l.Field])==null?void 0:P.search)==!0)return e.jsxs(e.Fragment,{children:[e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"search_type"],placeholder:"选择搜索类型",rules:[{required:!0,message:"请选择"}],options:z,fieldProps:{style:{margin:"2px 0px"},popupMatchSelectWidth:!1}},"search_type"),e.jsx(d,{name:[["react_list","list_fields_type_config",`${l.Field}`,"search_type"]],children:({react_list:b})=>{var T,C;const S=(C=(T=b==null?void 0:b.list_fields_type_config)==null?void 0:T[l.Field])==null?void 0:C.search_type;if(["select","treeSelect","cascader","checkbox","radio"].indexOf(S)!==-1)return e.jsxs(e.Fragment,{children:[e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"search_data_type"],placeholder:"选择数据源",rules:[{required:!0,message:"请选择"}],options:[{label:"自己填写选择项",value:1},{label:"API请求选择项",value:2}],fieldProps:{style:{margin:"2px 0px"},popupMatchSelectWidth:!1}},"search_data_type"),e.jsx(d,{name:[["react_list","list_fields_type_config",`${l.Field}`,"search_data_type"]],children:({react_list:v})=>{var D,I;if(((I=(D=v==null?void 0:v.list_fields_type_config)==null?void 0:D[l.Field])==null?void 0:I.search_data_type)==2)return e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"search_data_source_table"],placeholder:"请选择数据来源",options:y,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},extra:"选择项数据来源表",rules:[{required:!0,message:"请选择"}]},"search_data_source_table")}},"search_dependency")]});if(S=="selectTable")return e.jsx(s,{name:["react_list","list_fields_type_config",`${l.Field}`,"search_data_source_table"],placeholder:"请选择数据来源",options:y,showSearch:!0,fieldProps:{popupMatchSelectWidth:!1,allowClear:!0,style:{margin:"2px 0px"},fieldNames:{value:"Name",label:"Name"}},extra:"选择项数据来源表",rules:[{required:!0,message:"请选择"}]},"search_data_source_table")}},"search_dependency")]})}},"search_dependency")),i}})})}],rowKey:"Field",search:!1,pagination:!1,options:!1,defaultSize:"small",bordered:!0,dragSortKey:"sort",onDragSortEnd:(a,l,r)=>{h(r)},dataSource:m})})}}),e.jsx(A.Item,{name:"react_list_code",children:e.jsx(Q,{})})]})}),e.jsx(U,{offsetBottom:10,children:e.jsx(X,{boxShadow:!0,children:e.jsxs(Z,{align:"center",justify:"center",gap:"small",children:[e.jsx($,{type:"primary",size:"default",onClick:()=>{f.current.submit()},children:"保存设置》生成预览代码"}),e.jsx($,{danger:!0,onClick:()=>{M("react_list")},children:"生成到项目"})]})})})]})};export{vl as default};
